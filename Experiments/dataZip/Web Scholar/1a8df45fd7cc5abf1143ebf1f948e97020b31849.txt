Fast and stable rational approximation of generalized hypergeometric
functions
RICHARD MIKAËL SLEVINSKY*
Department of Mathematics, University of Manitoba, Winnipeg, Canada
July 13, 2023
Abstract
Rational approximations of generalized hypergeometric functions pFqof type (n+k, k)are constructed by the Drummond
and factorial Levin-type sequence transformations. We derive recurrence relations for these rational approximations that require
O[max{p, q}(n+k)]flops. These recurrence relations come in two forms: for the successive numerators and denominators;
and, for an auxiliary rational sequence and the rational approximations themselves. Numerical evidence suggests that these
recurrence relations are much more stable than the original formulæ for the Drummond and factorial Levin-type sequence
transformations. Theoretical results on the placement of the poles of both transformations confirm the superiority of factorial
Levin-type transformation over the Drummond transformation.
Keywords : Generalized hypergeometric functions. Drummond sequence transformation. Factorial Levin-type sequence
transformation.
1 Introduction
Generalized hypergeometric functions [1, §16] are formally equal to their Maclaurin series:
pFqα1, . . . , α p
β1, . . . , β q;z
=∞X
k=0(α1)k···(αp)k
(β1)k···(βq)kzk
k!, (1)
where (x)n= Γ(x+n)/Γ(x)is the Pochhammer symbol for the rising factorial [2, §6.1.22]. If some αj∈ −N0, then the
series terminates after at most αj+ 1terms. The Maclaurin series has radius of convergence 0ifp > q + 1,1ifp=q+ 1,
and∞ifp≤q.
Ifp≥q+ 1, the Maclaurin series may be analytically continued into an appropriately slit complex plane by the Meijer
G-function [1, §16.18.1] and its Mellin–Barnes integral representation [1, §16.17.1]:
pFqα1, . . . , α p
β1, . . . , β q;z
:=qY
k=1Γ(βk)
pY
k=1Γ(αk)G1,p
p,q+1
−z;1−α1, . . . , 1−αp
0,1−β1, . . . , 1−βq
, (2)
=1
2πiZ
C(α1)s···(αp)s
(β1)s···(βq)sΓ(−s)(−z)sds, (3)
where the contour Cseparates the poles of (αk)sfork= 1, . . . , p from those of Γ(−s)and is otherwise defined so that the
integral converges. When p=q+ 1, the functions are analytic in the cut plane C\[1,∞), and when p > q + 1, they are
analytic in the cut plane C\[0,∞). In any case, we take Eq. (2) to define the generalized hypergeometric functions and notice
that the Maclaurin series is the asymptotic expansion of the contour integral as z→0, whether the parameters and variable
dictate that this expansions is convergent or divergent.
*Email: Richard.Slevinsky@umanitoba.ca
1arXiv:2307.06221v1  [math.NA]  12 Jul 20232
Generalized hypergeometric functions serve as an umbrella to most of the early transcendentals and special functions of mathe-
matical physics; hence, they have many applications in a broad range of fields. Many numerical algorithms have been developed
for their computation [3–12], with a great majority focusing on Kummer’s and Tricomi’s confluent hypergeometric functions,
Gauss’ hypergeometric function, and others with p+q≤3, as a general observation. Moreover, several techniques in analytic
continuation have helped extend our computational abilities of these special functions, including the re-expansion formulæ of
Bühring [13, 14], and Padé approximants to some generalized hypergeometric functions by Iserles [15] and Sidi [16].
In this work, we utilize the Drummond sequence transformation and a factorial Levin-type transformation to produce rational
approximations of type (n+k, k)to generalized hypergeometric functions. Sequence transformations are a powerful tool to
accelerate the convergence of sequences (of partial sums) and, in case of divergence, to provide a reasonable antilimit. We
refer the interested reader to an incomplete collection of references [17–22] on the matter and references therein for their rich
history. The original formulæ for the rational approximations suffer from severe numerical instability with increasing kthat
complicates any use of a reasonable stopping criterion and leads to unanticipated divergence in finite precision floating-point
arithmetic. This numerical instability is due to two factors: that the rational function is represented as a polynomial divided by
another polynomial instead of a ratio of rationals; and, that the polynomials are expressed in the monomial basis. Moreover,
generating such sequences of rational approximations of type (n+ℓ, ℓ)forℓ= 0, . . . , k incurs a computational complexity of
O[k(n+k)]flops.
The generalized hypergeometric series in Eq. (1) is special because the ratio of successive terms is a fixed rational function of
the index. The converse is also true, whereby we relate the parameters to the negative roots and poles of that rational function
of the index. This fact enables us to develop recurrence relations for the numerator and denominator sequences of Drummond
and factorial Levin-type that cost O[max{p, q}(n+k)]flops to compute all rational approximations of type (n+ℓ, ℓ)for
ℓ= 0, . . . , k . By considering the ratios of successive denominators as an auxiliary rational sequence, recurrence relations
are produced that represent the transformations as ratios of rationals. This stabilized scheme enables a reasonable stopping
criterion to be effective at providing good results in finite precision.
We include a comprehensive suite of numerical examples to demonstrate the effectiveness of the new recurrence relations for
the Drummond and factorial Levin-type transformations in a finite precision environment, and we briefly discuss its possible
implementation in extended precision for guaranteed results. Finally, we include a discussion on the placement of the poles
of the rational functions and extensions and applications of this work. Our method is implemented in the J ULIA package
HypergeometricFunctions.jl [23].
2 Sequence transformations
Consider the model sequence {an}∞
n=0, its partial sums:
sn=nX
k=0ak,
and their limit s= lim n→∞sn(or antilimit in case of divergence [22]) so that:
s−sn=rn.
A large constructive class of sequence transformations results from a characterization of the remainder rnin terms of a nonzero
dominant controlling factor ωnmultiplied by a constructive refinement term z(k)
n, resulting in the transformation:
T(k)
n−sn=ωnz(k)
n. (4)
The index krefers to the number of unknowns appearing linearly in the constructive refinement. In particular, the equation
may be sampled at k+ 1distinct values of n, resulting in a (k+ 1)×(k+ 1) linear system of equations for the kunknowns
inz(k)
nand the value of the transformation T(k)
n. As the linear system is dense, the computational complexity of this general
approach is O(k3)flops.
To reduce the complexity, it has been noted that the values of z(k)
nare normally discarded; hence, for just the value of the
transformation T(k)
n, one expects to be able to reduce the complexity proportionally. In case the transformation is determined
bysn, . . . , s n+k, this can be done by dividing by the controlling factor ωnand applying a so-called annihilation operator [21]
to the refinements z(k)
n. We will now discuss two examples.3
2.1 Drummond’s sequence transformation
Drummond’s sequence transformation [17] is the result of using polynomial constructive refinements in Eq. (4), z(k)
n=
pk−1(n)where p−1(n)≡0so that deg(p−1) = 0 anddeg(pk−1) =k−1otherwise. It is well-known that the forward
finite difference operator ∆reduces the degree of a polynomial by one. Thus, ∆kpk−1(n)≡0.
Then:
T(k)
n=N(k)
n
D(k)
n=∆ksn
ωn
∆k1
ωn=kX
j=0k
j
(−1)k−jsn+j
ωn+j
kX
j=0k
j
(−1)k−j1
ωn+j(5)
For fixed k, Eq. (5) may be computed in O(n+k)flops, assuming ωncostsO(1)flops and snas a partial sum costs O(n)
flops. It is important to generate multiple transformations for contiguous kand fixed nto have a better picture of the sequence
of transformations of the partial sums. By using this formula for every ℓ= 0, . . . , k , this would cost O[k(n+k)]flops, a
quadratic complexity in k.
2.2 A factorial Levin-type sequence transformation
A factorial Levin-type transformation uses a constructive refinement term based on an inverse factorial series:
R(k)
n−sn=ωnk−1X
j=0cj
(n+γ)j, (6)
where cjare unknown constants and γ > 0is a usually small algorithmic parameter. This transformation first appeared in
the construction of rational and Padé approximants to certain generalized hypergeometric functions by Luke [24], Fields [25],
and Sidi [16]. It was cast as a sequence transformation by Shelef [26], and it was mildly generalized to its current form by
Weniger [20] through the introduction of the algorithmic parameter γ >0. It is called a Levin-type transformation due to the
seminal work by Levin [18] where the constructive refinement terms are bounded as n→ ∞ , as opposed to the polynomials
in the Drummond transformation, enabling the controlling factor to take on its tautological role.
Multiplying both sides of the equation by (n+γ)k−1/ωn, the right-hand side is again a polynomial that may be annihilated
by the kthorder finite difference. This results in a transformation:
R(k)
n=P(k)
n
Q(k)
n=∆k(n+γ)k−1sn
ωn
∆k(n+γ)k−1
ωn=kX
j=0k
j
(−1)k−j(n+j+γ)k−1sn+j
ωn+j
kX
j=0k
j
(−1)k−j(n+j+γ)k−1
ωn+j, (7)
that is a different weighted average of the partial sums. As with the Drummond transformation, Eq. (7) may be computed in
O(n+k)flops and computing the first ℓ= 0, . . . , k transformations costs O[k(n+k)]flops, also a quadratic complexity in k.
2.3 Explicit remainder estimates
The most reasonable choices of remainder estimates depend linearly on the sequence {an}∞
n=0itself. This was formalized
by Levin and Sidi [19] for the class of sequences that satisfy an mthorder linear homogeneous difference equation with
coefficients that have Poincaré-type asymptotic expansions as n→ ∞ .
Theorem 2.1 (Theorem 2 in [19]) .Let:
an=mX
k=1pk(n)∆kan,where pk(n)∼nik∞X
j=0bk,j
nj,asn→ ∞ ,
where ik≤k, fork= 1, . . . , m and suppose {sn}∞
n=0converges to s. If:
lim
n→∞
∆i−1pk(n)
∆k−ian
= 0,for k=i, . . . , m, i = 1, . . . , m,4
and if:
mX
k=1l(l−1)···(l−k+ 1)pk,0̸= 1,for l≥ −1,
where pk,0= lim n→∞n−kpk(n), then:
s−sn∼m−1X
k=0njk∆kan∞X
j=0ck,j
nj,asn→ ∞ ,
where jk≤max{ik+1, ik+2−1, . . . , i m−m+k+ 1}fork= 0, . . . , m −1.
In case m= 1, Theorem 2.1 describes a family of sequences whose remainders possess an asymptotic expansion that depends
linearly on an. This theorem justifies the remainder estimates of inverse power series as in the original Levin transforma-
tion [18], as well as the remainder estimates of the inverse factorial series in Eq. (6). Theorem 2.1 does not rigorously justify
the remainder estimates in Drummond’s transformation. Note that if ansatisfies the conditions of Theorem 2.1, then we may
takeωn=nj0an=nj0∆sn−1, where j0≤1. Since the leading coefficients in the inverse power series may turn out to be
zero, this is a subset of the choice ωn= (n+γ)an. Several remainder estimates have appeared in the literature [18, 20, 27],
including:
ωn=

an= ∆sn−1,
an+1= ∆sn,
(n+γ)an= (n+γ)∆sn−1,
anan+1
an+1−an=∆sn−1∆sn
∆2sn−1,(8)
among others.
In the context of generalized hypergeometric functions, we observe that:
an+1
an=(α1+n)···(αp+n)
(β1+n)···(βq+n)z
n+ 1,
and it is easily verified that the sequence satisfies the conditions of Theorem 2.1 with m= 1, namely a first-order linear homo-
geneous difference equation with a coefficient that has a Poincaré-type asymptotic expansion as n→ ∞ . In this way, R(k)
nis
a theoretically acceptable transformation for the class of convergent hypergeometric functions while T(k)
nis not. Nevertheless,
we shall continue to consider both methods and offer another justification in § 2.4.
In this work, we describe algorithms to compute both the Drummond and factorial Levin-type transformations in linear com-
plexity with respect to the transformation order kwhen ωn/ωn+1andan/ωnare rational. As will be seen below, these two
conditions imply that an+1/anis rational. Thus, they are a specialization on the class of sequences with rational successive
ratios whose controlling factors also have rational successive ratios.
Lemma 2.2. Ifωn/ωn+1andan/ωnare rational, then an+1/anis also rational.
Proof. This follows from:
an+1
an=an+1
ωn+1an
ωnωn+1
ωn.
Recurrence relations have been developed [20] to transform the sequences of partial sums {T(0)
n+ℓ}k
ℓ=0and{R(0)
n+ℓ}k
ℓ=0to the
respective sequences {T(ℓ)
n}k
ℓ=0and{R(ℓ)
n}k
ℓ=0. However, these only simplify the construction of binomial coefficients and do
not reduce the complexity of the procedure.
2.4 Convergence of the Drummond and Levin-type transformations applied to Euler’s divergent
series
We include here two remarkable results by Borghi and Weniger [28] on the resummation of Euler’s divergent series:
∞X
k=0k!zk∼Z∞
0e−t
1−ztdt=2F0(1,1;z),for z∈C\(0,∞).5
Theorem 2.3 (Theorems 5.5 and 6.7 in [28]) .Ifωn= ∆snandγ= 1, then for every z∈C\[0,∞):
2F0(1,1;z)−T(k)
0∼2π
zexp−1
z−4k1/2
(−z)1/2
,
2F0(1,1;z)−R(k)
0∼4π
zexp−1
z−9k2/3
2(−z)1/3
cos33/2k2/3
2(−z)1/3+π
6
,ask→+∞.
On the negative real line, the dominant factors in the two convergence rates live in the argument of the exponential: Drum-
mond’s transformation has square root-exponential convergence while the factorial Levin-type transformation has an algebraic-
exponential convergence closer to bona fide exponential convergence. Of secondary importance is that the constants in the
convergence rates are z-dependent; in both cases, the convergence is faster for znear the origin.
2.5 Instability in the original formulæ
In the case of generalized hypergeometric functions, both transformations produce rational functions of type (n+k, k)of the
complex variable zfor any one of the remainder estimates in Eq. (8). Direct use of Eqs. (5) and (6) is cause for caution. For
they both represent the rational approximations as ratios of polynomials in the monomial basis. However, there is no a priori
reason to believe that the monomial basis is in any way optimal. If an appropriate remainder estimate is strictly alternating, then
it is easy to confirm that the denominators in Eqs. (5) and (6) are sums of terms of the same sign. This captures the best case
scenario as subtractive cancellation may only occur in the numerators, and indeed it does if the sequence is strictly alternating.
It turns out that this may still be quite severe because the numerators involve a double summation where inner summation is
not simplified analytically when computing numerically. We call this a best case scenario because strict alternation in sign may
only be true for evaluation of generalized hypergeometric functions on a semi-axis of the complex variable z, while we are
naturally interested in the greater complex plane.
As will be seen in § 3, our fast algorithms define the numerators and denominators by recurrence relations whose lengths are
independent of nandk. Notwithstanding the reduction in quadratic to linear complexity, our fast algorithms have a profound
impact on the numerical stability of the transformations as they use the successive numerators and denominators as their
own polynomial bases. This is akin to computing orthogonal polynomials by their three-term recurrence relation as opposed
to expansion in the monomial basis, which is unstable in general. While using the numerators and denominators as their
own bases substantially improves of the stability of the algorithms, it does not guard against the real possibility of numerical
overflow or underflow. Moreover, while rational functions in a compact subset of Cmay be bounded, their representative
ratio of polynomials may have a large dynamic range. We further stabilize our algorithm in § 3.1.2 by converting our ratio of
polynomials into a ratio of rationals, which has been observed in the AAA algorithm [29] to be the best form for a rational
approximant, among a ratio of polynomials, a ratio of rationals, and the partial fraction decomposition. With our stable ratio
of rationals, a reasonable stopping criterion is proposed in § 3.1.3 that ascertains whether two successive transformations are
numerically close.
Figure 1 serves as a review of the aforementioned issues and a preview of their resolution by this work. In double precision,
we consider the summation of a strictly alternating divergent series:
2F0(1,1;−2)≈0.461 455 316 241 865 234 . . . . (9)
where we have used a strictly alternating remainder estimate ωn=an+1, and parameters γ= 2andn= 0in the Drummond
and factorial Levin-type transformation. We observe that the original formulæ may come close to a good approximation, but
soon the instabilities in Eqs. (5) and (6) quickly lead to factorial divergence. On the other hand, the new methods demonstrate
the algebraic-exponential convergence of Theorem 2.3 with high fidelity and rounding errors that approximately accumulate at
the much slower rate of O(kϵmach).
3 Linear complexity recurrence relations
Recall the finite product rule:
∆k(fngn) =kX
j=0k
j
∆jfn+k−j∆k−jgn. (10)6
100101102103104
Order k1016
1014
1012
1010
108
106
104
102
100Approximate Relative Error
T(k)
0 (unstable)
R(k)
0 (unstable)
T(k)
0 (stable)
R(k)
0 (stable)
100101102103104
Order k1016
1014
1012
1010
108
106
104
102
100True Relative Error
T(k)
0 (unstable)
R(k)
0 (unstable)
T(k)
0 (stable)
R(k)
0 (stable)
Figure 1: Comparison of direct implementation of the Drummond and factorial Levin-type sequence transformations, labeled
unstable, and the linear complexity recurrence relations derived in this work, labeled stable. In the left panel, the approximate
relative error is that computed by using the next order transformation as the “true” value, whereas in the right panel the true
relative error uses Eq. (9), whose listed digits are correctly rounded (and truncated). In both panels, the black line indicates
8ϵmach≈1.77×10−15in double precision. The reasonable stopping criterion of § 3.1.3 selects the two values that are circled,
T(137)
0 andR(34)
0, which are ostensibly, according to Eq. (16), the second values of the respective transformations to fall below
the threshold of 8ϵmach in the left panel. As can be seen in the right panel, it provides no guarantee on the true relative error.
3.1 Drummond’s sequence transformation
Theorem 3.1. Letωn/ωn+1andan/ωnbe rational. Then there exist recurrence relations for the numerator and denominators
of Drummond’s sequence transformation, whose length is independent of nandk.
Proof. In the case of the denominator, we begin with the initial conditions:
D(0)
n=1
ωn, D(0)
n+1=1
ωn+1,
so that:
D(0)
n+1=ωn
ωn+1D(0)
n.
Asωn/ωn+1is rational, we express it as the ratio of two polynomials, qn/pn, where deg(pn) =panddeg(qn) =q, so that:
pnD(0)
n+1=qnD(0)
n.
Applying ∆kto both sides and using D(k+1)
n = ∆D(k)
nwe find:
min{k,p}X
j=0k
j
∆jpn+k−jD(k−j)
n+1=min{k,q}X
j=0k
j
∆jqn+k−jD(k−j)
n, (11)
where polynomial coefficients living in the kernel of sufficiently high order finite differences is cause for the minima in the
summation indices.
Since, on the left-hand side, D(k−j)
n+1= ∆D(k−j)
n +D(k−j)
n =D(k+1−j)
n +D(k−j)
n , the recurrence relation only involves the
subsequence {D(k−j)
n}min{k,max{p,q}}
j=−1 , with fixed n.
As for the numerator sequence, the initial conditions read:
N(0)
n=sn
ωn, N(0)
n+1=sn+1
ωn+1=ωn
ωn+1sn
ωn+an+1
ωn+1,7
so that:
N(0)
n+1=ωn
ωn+1N(0)
n+an+1
ωn+1.
Thus, there exist polynomials un,vn, and wnsuch that:
unN(0)
n+1=vnN(0)
n+wn.
By the same technique for the denominator sequence:
min{k,u}X
j=0k
j
∆jun+k−jN(k−j)
n+1=min{k,v}X
j=0k
j
∆jvn+k−jN(k−j)
n + ∆kwn, (12)
where deg(un) =uanddeg(vn) =v. The inhomogeneity is present for k≤deg(wn) =w.
Some controlling factors allow one to relate un,vnandwndirectly to pnandqn. One such choice is the remainder estimate
ωn= ∆sn=an+1, so that the numerator recurrence becomes:
pnN(0)
n+1=qnN(0)
n+qn.
Another reasonable choice is the remainder estimate ωn= ∆sn−1=an. In this case, an+1/ωn+1= 1, and the numerator
recurrence becomes:
pnN(0)
n+1=qnN(0)
n+pn.
The other two choices in Eq. (8) are acceptable, though the polynomial coefficients are more involved.
3.1.1 Computational considerations
A direct use of the recurrence relations for the numerator and denominator sequences in Eqs. (11) and (12) would cost
O[max{p, q, u, v, w }2(n+k)]flops to compute the first k+ 1 terms, as a result of computing the binomial and variable
coefficients, such as {∆jpn+k−j}p
j=0, directly. We will now show that the product of binomial and variable coefficients may
be obtained by an incremental calculation that reduces the overall complexity to O[max{p, q, u, v, w }(n+k)]flops. We will
illustrate the method for the denominator recurrence as it applies equally to the numerator recurrence.
Defining:
p(k)
n,j=k
j
∆jpn+k−j,and q(k)
n,j=k
j
∆jqn+k−j, (13)
then Eq. (11) is equal to:
min{k,p}X
j=0p(k)
n,jD(k−j)
n+1=min{k,q}X
j=0q(k)
n,jD(k−j)
n.
By induction and the use of the finite difference operator, it follows that:
p(k)
n,j=p(k−1)
n+1,j+ ∆p(k−1)
n,j−1,and q(k)
n,j=q(k−1)
n+1,j+ ∆q(k−1)
n,j−1, (14)
where it is understood that p(k)
n,j=q(k)
n,j= 0ifj <0orj > k . However, more efficient recurrence relations for Eq. (13) may
be utilized that reduce the flops and extra memory requirements:
jp(k)
n,j= (k−j+ 1)p(k)
n,j−1−kp(k−1)
n,j−1,and jq(k)
n,j= (k−j+ 1)q(k)
n,j−1−kq(k−1)
n,j−1, (15)
Notice that Eq. (14) requires evaluating p(k−1)
n+1,jand also p(k−1)
n+1,j−1through the finite difference, which requires the evaluation
ofp(k)
n,jfor different values of n. On the other hand, once p(k)
n,0=pn+kis computed, incrementing jvia Eq. (15) is a linear
combination of two p(k)
n,jwith the same index n. This ensures that the kthrow in the table of p(k)
n,jmay be computed in O(p)
flops. We find that the same argument holds for qn,un, and vn.
The computational pattern in the numerical implementation of Eq. (15) is pictured in Figure 2.8
p(k−1)
n,j−1
p(k)
n,j−1 p(k)
n,jq(k−1)
n,j−1
q(k)
n,j−1 q(k)
n,j
Figure 2: The computational pattern of Eq. (15).
3.1.2 From a ratio of polynomials to a ratio of rationals
As the resulting approximation is rational, we may rescale the sequence of numerators and denominators by the same power
of the floating-point base to insure against overflow and underflow in the working precision to bring the magnitudes back into
the representable range while not introducing any further rounding errors. This method, however, introduces a branch in the
iteration and depends on floating-point implementation details, which are not universally portable. As such, we rely on another
technique that also guards against overflow and underflow.
Consider µ(k)
nto be the reciprocal ratio of successive denominators:
µ(k)
n=D(k−1)
n
D(k)
n, µ(0)
n=1
D(0)
n.
Then Eq. (11) is equivalent to:
min{k,p}X
j=0p(k)
n,j 
1
µ(k−j+1)
n+ 1!
µ(k)
n···µ(k−j+1)
n =min{k,q}X
j=0q(k)
n,jµ(k)
n···µ(k−j+1)
n .
Notice that both of these summations may be computed by a generalized Horner scheme [30]:
min{k,p}X
j=0p(k)
n,j 
1
µ(k−j+1)
n+ 1!
µ(k)
n···µ(k−j+1)
n
=p(k)
n,0 
1
µ(k+1)
n+ 1!
+
p(k)
n,1
µ(k)
n+ 1
+µ(k)
n
p(k)
n,2
µ(k−1)
n + 1
+···
,
min{k,q}X
j=0q(k)
n,jµ(k)
n···µ(k−j+1)
n =q(k)
n,0+µ(k)
n
q(k)
n,1+µ(k−1)
n
q(k)
n,2+···
.
With the ratio of successive denominators in hand, the numerator recurrence in Eq. (12) may be transformed into a recurrence
relation for the transformation T(k)
nitself:
min{k,u}X
j=0u(k)
n,j 
T(k−j+1)
n
µ(k−j+1)
n+T(k−j)
n!
µ(k)
n···µ(k−j+1)
n =min{k,v}X
j=0v(k)
n,jT(k−j)
n µ(k)
n···µ(k−j+1)
n + 
∆kwn
µ(k)
n···µ(0)
n.
A generalized Horner scheme is also effective in the numerical evaluation of these sums.
To see why this formulation as a ratio of rationals is effective at deferring overflow, we observe that the more rapidly µ(k)
n
decays, the more damped are the successive terms in the summations. Therefore, a consistent asymptotic approximation has
the leading term:
1
µ(k+1)
n∼q(k)
n,0−p(k)
n,0−p(k)
n,1
p(k)
n,0,ask→ ∞ .
As the coefficients are polynomials, the growth rate of this asymptotic approximation is substantially lower than the successive
denominators themselves, which would grow factorially as they are recovered by the product of the successive ratios. In finite
precision, this usually defers overflow far beyond an order kwhere convergence sets in.9
3.1.3 A reasonable stopping criterion
We have found that by virtue of the increased numerical stability in the linear complexity recurrence relations, a reasonable
stopping criterion is useful in returning approximate numerical results. Given a small tolerance, say tol= 8ϵmach , if:
|T(k)
n−T(k−1)
n| ≤max{|T(k)
n|,|T(k−1)
n|}tol, (16)
then we return the value T(k)
nas the output of the algorithm. We also insure against false convergence of the algorithm, which
we have found may occur for k≤r+ 2, where successive transformations may be numerically identical though are far from
the limit of successive approximations.
There is of course no guarantee of convergence in the use of Eq. (16): in particular, the stopping criterion only implies
that two successive transformations are relatively close. For any particularly ill-conditioned input sequence, rounding errors
may be so amplified that the stopping criterion is never satisfied. Hence, it is necessary to also provide a maximum type of
rational approximation, say (n+kmax, kmax)where kmax= 1,048,576. Such a maximum type only affects the maximum
computational time, not the memory requirements; hence, the setting of kmaxis provided as an option with a default to the
user. When the maximum type is reached, the output is returned with a warning. With such a stopping criterion, the algorithm
may be easily adapted to return guaranteed results in an extended precision environment such as MPFR [31] or Arb [32]: for
a target result of pcorrect bits, one runs the algorithm with q >2pand2qbits, doubling q, until the first pbits of both results
agree. As the method is generic to the data types of the parameters and the variable z, more sophisticated techniques involving
interval and ball arithmetic can be used to increase the required internal precision by just as much as necessary.
3.2 A factorial Levin-type sequence transformation
Theorem 3.2. Letωn/ωn+1andan/ωnbe rational. Then there exist recurrence relations for the numerator and denominators
of Levin’s factorial sequence transformation, whose length is independent of nandk.
Before the proof, we state a number of partial results. By Eq. (7), it follows that:
Q(0)
n=1
(n+γ−1)ωn, (17)
and:
Q(k)
n= ∆kh
(n+γ−1)kQ(0)
ni
. (18)
Lemma 3.3. Denominators in Levin’s factorial sequence transformation satisfy:
Q(k+1)
n = [(n+γ+ 2k)∆ + ( k+ 1)I]Q(k)
n, (19)
and:
∆sQ(k+1)
n = [(n+γ+ 2k+s)∆ + ( k+s+ 1)I] ∆sQ(k)
n, (20)
Proof. By Eq. (18):
Q(k+1)
n = ∆k+1h
(n+γ−1)k+1Q(0)
ni
,
= ∆k+1h
(n+γ+k−1)(n+γ−1)kQ(0)
ni
,
= (n+γ+ 2k)∆k+1h
(n+γ−1)kQ(0)
ni
+ (k+ 1)∆kh
(n+γ−1)kQ(0)
ni
,
= [(n+γ+ 2k)∆ + ( k+ 1)I]Q(k)
n.
The higher order recurrence is established by a similar observation. In particular:
∆s[(n+γ+ 2k)∆] = [( n+γ+ 2k+s)∆ + sI] ∆s.10
Lemma 3.4. Given a sequence {an}∞
n=0, define the sequence {bn}∞
n=0by the generalized binomial transform:
bn=nX
k=0n
k
(c+n)kak, c / ∈ −N. (21)
Then the original sequence is recovered by:
an=nX
k=0n
k
(−1)n−kc+ 2k
(c+k)n+1bk. (22)
Proof. Substituting anfrom the second equation into the first:
bn=nX
k=0n
k
(c+n)kkX
j=0k
j
(−1)k−jc+ 2j
(c+j)k+1bj,
=nX
j=0bj(c+ 2j)nX
k=jn
kk
j
(−1)k−j(c+n)k
(c+j)k+1.
Sincen
kk
j
=n
jn−j
k−j
,
bn=nX
j=0n
j
bj(c+ 2j)nX
k=jn−j
k−j
(−1)k−j(c+n)k
(c+j)k+1,
=nX
j=0n
j
bj(c+ 2j)(c+n)j
(c+j)j+1n−jX
k=0n−j
k
(−1)k(c+n+j)k
(c+ 2j+ 1) k,
=nX
j=0n
j
bj(c+n)j
(c+j)j2F1
j−n, c+n+j
c+ 2j+ 1; 1
.
By the Chu–Vandermonde identity [1, §15.4.24]:
bn=nX
j=0n
j
bj(c+n)j
(c+j)j(j−n+ 1) n−j
(c+ 2j+ 1) n−j=nX
j=0bjδn,j,
where δn,jis the Kronecker delta [1, §1].
We are now in a position to relate higher order finite differences of Q(k)
nto successively indexed denominators (in k).
Lemma 3.5.
Q(k+r)
n =rX
s=0r
s
(n+γ+ 2k+r−1)s(k+s+ 1) r−s∆sQ(k)
n, (23)
∆rQ(k)
n=rX
s=0r
s
(−1)r−sn+γ+ 2k+ 2s−1
(n+γ+ 2k+s−1)r+1(k+s+ 1) r−sQ(k+s)
n. (24)
Proof. We prove this lemma by induction. For r= 0, Eq. (23) is an identity, and for r= 1, Eq. (23) is equal to Eq. (19). By
Eq. (19) with k→k+r:
Q(k+r+1)
n = [(n+γ+ 2k+ 2r)∆ + ( k+r+ 1)I]Q(k+r)
n
= (n+γ+ 2k+ 2r)"rX
s=0r
s
(n+γ+ 2k+r)s(k+s+ 1) r−s∆s+1Q(k)
n
+rX
s=0r
s
∆(n+γ+ 2k+r−1)s(k+s+ 1) r−s∆sQ(k)
n#
+rX
s=0r
s
(n+γ+ 2k+r−1)s(k+s+ 1) r+1−s∆sQ(k)
n11
In the first summation, we substitute s→s+ 1, and thanks to the binomial coefficients all three summations may be extended
to share the same summation limits:
Q(k+r+1)
n =r+1X
s=0r
s−1
(n+γ+ 2k+ 2r)(n+γ+ 2k+r)s−1(k+s)r+1−s∆sQ(k)
n
+r
s
(n+γ+ 2k+ 2r)s(n+γ+ 2k+r)s−1(k+s+ 1) r−s∆sQ(k)
n
+r
s
(n+γ+ 2k+r−1)s(k+s+ 1) r+1−s∆sQ(k)
n.
Since (k+s)r+1−s= (k+s)(k+s+ 1) r−s, the first two terms may be combined:
Q(k+r+1)
n =r+1X
s=0r
s−1
(k+s) +r
s
s
(n+γ+ 2k+ 2r)(n+γ+ 2k+r)s−1(k+s+ 1) r−s∆sQ(k)
n
+r
s
(n+γ+ 2k+r−1)s(k+s+ 1) r+1−s∆sQ(k)
n.
Using the binomial identity:r
s−1
(k+s) +r
s
s=r
s−1
(k+r+ 1),
we find:
Q(k+r+1)
n =r+1X
s=0r
s−1
(n+γ+ 2k+ 2r)(n+γ+ 2k+r)s−1(k+s+ 1) r+1−s∆sQ(k)
n
+r
s
(n+γ+ 2k+r−1)s(k+s+ 1) r+1−s∆sQ(k)
n,
=r+1X
s=0r
s−1
(n+γ+ 2k+ 2r) +r
s
(n+γ+ 2k+r−1)
(n+γ+ 2k+r)s−1(k+s+ 1) r+1−s∆sQ(k)
n.
Two more binomial identities result in the equality:
r
s−1
(n+γ+ 2k+ 2r) +r
s
(n+γ+ 2k+r−1) =r+ 1
s
(n+γ+ 2k+r+s−1),
so that:
Q(k+r+1)
n =r+1X
s=0r+ 1
s
(n+γ+ 2k+r)s(k+s+ 1) r+1−s∆sQ(k)
n,
which completes the proof of Eq. (23). Since (k+s+ 1) r−s=Γ(k+r+ 1)
Γ(k+s+ 1)is a product of a function of rtimes a function
ofs, the inverse formula in Eq. (24) follows from Lemma 3.4.
Proof of Theorem 3.2. In the case of the denominator, we begin with the initial conditions:
Q(0)
n=1
(n+γ−1)ωn, Q(0)
n+1=1
(n+γ)ωn+1,
so that:
(n+γ)Q(0)
n+1= (n+γ−1)ωn
ωn+1Q(0)
n.
Asωn/ωn+1is rational, we express it as the ratio of two polynomials, qn/pn, where deg(pn) =panddeg(qn) =q, so that:
(n+γ)pnQ(0)
n+1= (n+γ−1)qnQ(0)
n.12
For any natural number r, applying ∆k[(n+γ)k−r−1⋄]and using ˆpn= (n+γ)pn, we find:
∆kh
(n+γ)k−r−1ˆpnQ(0)
n+1i
= ∆kh
(n+γ−1)k−rqnQ(0)
ni
, (25)
min{k,p+1}X
j=0k
j
∆jˆpn+k−j∆k−jh
(n+γ)k−r−1Q(0)
n+1i
=min{k,q}X
j=0k
j
∆jqn+k−j∆k−jh
(n+γ−1)k−rQ(0)
ni
, (26)
min{k,p+1}X
j=0k
j
∆jˆpn+k−j∆r+1−jQ(k−r−1)
n+1 =min{k,q}X
j=0k
j
∆jqn+k−j∆r−jQ(k−r)
n. (27)
By Lemma 3.5, we observe that higher order finite differences of denominators are linear combinations of successive denomi-
nators. Thus, Eq. (27) only involves the subsequence {Q(k−j)
n}r+1
j=−1. We shall return to this observation in § 3.2.1.
As for the numerator sequence, the initial conditions read:
P(0)
n=sn
(n+γ−1)ωn, P(0)
n+1=sn+1
(n+γ)ωn+1,
so that:
(n+γ)P(0)
n+1= (n+γ−1)ωn
ωn+1P(0)
n+an+1
ωn+1.
Asωn/ωn+1andan+1/ωn+1are rational, there exist polynomials un,vn, and wnsuch that:
(n+γ)unP(0)
n+1= (n+γ−1)vnP(0)
n+wn.
Using the same technique as for the denominator sequence, we define ˆun= (n+γ)unand:
min{k,u+1}X
j=0k
j
∆jˆun+k−j∆r+1−jP(k−r−1)
n+1 =min{k,v}X
j=0k
j
∆jvn+k−j∆r−jP(k−r)
n + ∆k[(n+γ)k−r−1wn]. (28)
If we take r=r∗:= max {p+ 1, q, u + 1, v, w}, then for every k≥r∗+ 1:
deg(( n+γ)k−r∗−1wn) =k−r∗−1 +w≤k−1,
which shows that the presence of the inhomogeneity in the recurrence relation for the numerator sequence is evanescent and
both recurrence relations in Eqs. (27) and (28) have length independent of nandk.
Ifγis a natural number, for sufficiently small n+kand sufficiently large r, the inhomogeneity, ∆k[(n+γ)k−r−1wn]will be
singular through the Pochhammer symbol’s poles. Moreover, if γis in the neighbourhood of a natural number, then the issue
becomes one of numerical instability as opposed to outright singularity. To avoid this problem, for k≤r∗, the recurrence
relations employed with r=k−1have no singularity present in the inhomogeneity.
Remark 3.6. We have found that a special case arises in practice that reduces the length of the recurrence relations by one.
Ifn+γdivides qn,vnandwn, then the recurrence relations are simplified by letting qn= (n+γ)ˆqn,vn= (n+γ)ˆvn,
wn= (n+γ) ˆwn, and r=r⋆:= max {p, q−1, u, v−1, w−1}to:
min{k,p}X
j=0k
j
∆jpn+k−j∆r+1−jQ(k−r−1)
n+1 =min{k,q−1}X
j=0k
j
∆jˆqn+k−j∆r−jQ(k−r)
n, (29)
min{k,u}X
j=0k
j
∆jun+k−j∆r+1−jP(k−r−1)
n+1 =min{k,v−1}X
j=0k
j
∆jˆvn+k−j∆r−jP(k−r)
n + ∆k[(n+γ)k−r−1ˆwn]. (30)13
3.2.1 Computational considerations
By using Eq. (24) in Eqs. (27) and (28), exchanging the order of summations yields:
r+1X
j=0ˆp(k)
n,j(r)(n+γ+ 2k−2j)Q(k−j)
n+1=rX
j=0q(k)
n,j(r)(n+γ+ 2k−2j−1)Q(k−j)
n,
r+1X
j=0ˆu(k)
n,j(r)(n+γ+ 2k−2j)P(k−j)
n+1=rX
j=0v(k)
n,j(r)(n+γ+ 2k−2j−1)P(k−j)
n + ∆k[(n+γ)k−r−1wn].
where:
ˆp(k)
n,j(r) =min{k,j,p +1}X
s=0k
sr+ 1−s
r+ 1−j(−1)j−s(k−j+ 1) j−s
(n+γ+ 2k−j−r−1)r−s+2∆sˆpn+k−s,
q(k)
n,j(r) =min{k,j,q}X
s=0k
sr−s
r−j(−1)j−s(k−j+ 1) j−s
(n+γ+ 2k−j−r−1)r−s+1∆sqn+k−s,
ˆu(k)
n,j(r) =min{k,j,u +1}X
s=0k
sr+ 1−s
r+ 1−j(−1)j−s(k−j+ 1) j−s
(n+γ+ 2k−j−r−1)r−s+2∆sˆun+k−s,
v(k)
n,j(r) =min{k,j,v}X
s=0k
sr−s
r−j(−1)j−s(k−j+ 1) j−s
(n+γ+ 2k−j−r−1)r−s+1∆svn+k−s.
The beauty of these formulæ is that we may derive recurrence relations between adjacent entries. For ˆp, we find:
jˆp(k)
n,j(r) + (n+γ+ 2k−j−r−2)kˆp(k−1)
n,j−1(r) (31)
= (k−j+ 1)h
(n+γ+ 2k−j+ 1)ˆp(k)
n,j−1(r)−(r−j+ 3)kˆp(k−1)
n,j−2(r)i
,
in general and for r=k−1:
jˆp(k)
n,j(k−1) +kˆp(k−1)
n,j−1(k−2) (32)
= (k−j+ 1)h
(n+γ+ 2k−j+ 1)ˆp(k)
n,j−1(k−1) +kˆp(k−1)
n,j−2(k−2)i
.
Forq, we find:
jq(k)
n,j(r) + (n+γ+ 2k−j−r−2)kq(k−1)
n,j−1(r) (33)
= (k−j+ 1)h
(n+γ+ 2k−j)q(k)
n,j−1(r)−(r−j+ 2)kq(k−1)
n,j−2(r)i
,
in general and for r=k−1:
jq(k)
n,j(k−1) +kq(k−1)
n,j−1(k−2) (34)
= (k−j+ 1)h
(n+γ+ 2k−j)q(k)
n,j−1(k−1) +kq(k−1)
n,j−2(k−2)i
.
By analogy, recurrence relations with the same structures hold for ˆu(k)
n,jandv(k)
n,j, respectively. Once k=r∗+ 1, we notice
thatˆp(k)
n,j(r∗)≡ˆp(k)
n,j(k−1)andq(k)
n,j(r∗)≡q(k)
n,j(k−1)and we may switch from Eqs. (32) and (34) to Eqs. (31) and (33),
respectively, where there are no singularities in the coefficients and the order kis sufficiently large that the numerator recurrence
is homogeneous.
The computational pattern in the numerical implementation of Eqs. (31)–(34) is pictured in Figure 3.
The method benefits from the following scaling of the numerators and denominators:
P(k)
n= (n+γ)k−1˜P(k)
n,and Q(k)
n= (n+γ)k−1˜Q(k)
n.
Furthermore, as with the Drummond transformation, the recurrence relations for the numerator and denominator sequences of
polynomials can be converted into recurrence relations for an auxiliary rational sequence and the sequence of transformations.
We elide the description as it would be identical to § 3.1.2. Combined, these two observations defer numerical overflow to an
order kthat far exceeds what is used in practice. We use the same reasonable stopping criterion described in § 3.1.3 in our
implementation of this transformation.14
ˆp(k−1)
n,j−2 ˆp(k−1)
n,j−1
ˆp(k)
n,j−1 ˆp(k)
n,jq(k−1)
n,j−2 q(k−1)
n,j−1
q(k)
n,j−1 q(k)
n,j
Figure 3: The computational pattern of Eqs. (31)–(34).
4 Numerical results
In this section, we use the linear complexity recurrence relations for the Drummond and factorial Levin-type sequence trans-
formations to approximate generalized hypergeometric functions pFq(α, β;z). All experiments are performed on an iMac Pro
(Early 2018) with a 2.3 GHz Intel Xeon W-2191B processor. Our free and open-source implementation lives in the J ULIA
package HypergeometricFunctions.jl [23].
By choosing any one of the remainder estimates in Eq. (8) or others in the same spirit, different families of rational approxi-
mations may be generated. We have found the differences to be quite subtle, and therefore we will present all of our numerical
results with a single choice of remainder estimate — the original choice in the Drummond transformation [17], and one that
has also been proposed elsewhere [20, 28, 33]:
ωn= ∆sn=an+1. (35)
Moreover, we only present numerical results for n= 0, computing the type (k, k)rational approximations. As with Padé
approximants, more power is usually gained with equal degree numerator and denominator than by fixing the degree of the
denominator. In the factorial Levin-type transformation, we have found that the parameter γhas only a small impact on the
results, provided it is not too large. In the numerical experiments, we set γ= 2.
AspandqinpFqincrease, we are faced with an increasing dimension of the parameter space. While randomization in testing
may increase confidence in the output, we believe that the parameter space is still too large for randomization to yield anything
more meaningful than deterministic tests. We also wish to view the errors in the complex z-plane; hence, deterministic and
reproducible values of the parameters are elected. Given the above restrictions, any numerical experiments with sequence
transformations approximating generalized hypergeometric functions can only be indicative rather than exhaustive.
Apart from terminating series (polynomials), generalized hypergeometric functions pFqare: entire when p≤q; analytic in
the cut plane C\[1,∞)when p=q+ 1; or, analytic in the cut plane C\[0,∞)when p > q + 1. As 0F0(;z)≡ezand
1F0(α;z)≡(1−z)−α, we shall use 1F1,2F1, and 2F0as nontrivial numerical representatives of each of these respective
classes. For the purposes of calculating errors, we shall take the approximations R(k)
0obtained in extended 128-bit precision
as true values, while the approximations under examination are calculated in 64-bit precision; in the complex plane, we
are using a tuple of equally precise floating-point numbers for the real and imaginary parts. Each of Figures 4–9 contains
four panels illustrating, clockwise from top left: the phase portrait of the transformations at a fixed k, the phase portrait
of the transformations with the order kdetermined by the reasonable stopping criterion; the relative error computed with
the reasonable stopping criterion; and, the relative error at a fixed k. Phase portraits are an important qualitative tool in
computational complex analysis because they plainly reveal roots, poles, and branch cuts. For a root, one observes a point in
which the red-green-blue (RGB) colour wheel is traversed counterclockwise. For a pole, the RGB colour wheel is traversed
clockwise. The contour plots of the relative error are clamped between 10−16and100to assist in the visualization of the plots.
All plots are formed from numerical evaluations on 300×300equispaced grids.
Comparing Figures 4 and 5, we see that for the same order of transformation, k= 10 , the factorial Levin-type transformation
includes a larger region with lower relative error than the Drummond transformation in approximating the entire function 1F1,
which is in part explained by the poles of the former being further from the origin. The reasonable stopping criterion is less
accurate in the right-half part of the complex plane.
With Figures 6 and 7, we are reporting the approximations to the analytic function 2F1in the cut plane C\[1,∞). In both
cases, it is unfortunate that the spurious pole-root pairs do not reside on the function’s branch cut. For the Drummond trans-
formation, pole-root pairs appear to converge to the line ℜz=1
2, which has serious consequences for the transformation’s15
ability to approximate the function to the right of this line: it appears to present a form of false converge to something com-
pletely fictitious but perhaps related to the function in hand. On the other hand, the pole-root pairs of the factorial Levin-type
transformation appear to converge to the branch cut, enabling the reasonable stopping criterion to succeed in approximating
the function with high relative accuracy all the way up to the cut. It then follows by regular perturbation theory that in general
we cannot expect the spurious pole-root pairs of either transformation to live on the branch cut for any q+1Fq. Numerical
experiments suggest that the description above is representative of the entire class, apart from select cases where the factorial
Levin-type transformation’s pole-root pairs do appear on the cut. We shall return to this point in the next section.
Regarding generalized hypergeometric functions analytic in the cut plane C\[0,∞), Figures 8 and 9 show how the trans-
formations approximating 2F0have their spurious root-pole pairs placed on the positive real axis. The phase portraits are
sharp along the branch cut with the stopping criterion, though the accuracy of the Drummond transformation deteriorates most
noticeably in the right-half complex plane.
Finally, Figures 10 and 11 illustrate, for the same three generalized hypergeometric functions, the order kupon which the
algorithm exits and the corresponding execution time in seconds, reported as an average over 10runs. The order kis clamped
between 101and106and the time is clamped between 10−6and10−1seconds to assist in the visualization of the plots. A
close inspection shows that there is an approximately one-to-one correspondence between all plots in the top row and those
directly below. Since the contours are plotted over the same relative range, we consider this to be a numerical proof that the
linear complexity of the recurrence relations is realized in practice. For the Drummond transformation, we observe that the line
ℜz=1
2of accumulation of pole-root pairs of 2F1is expensive, while the false convergence to the right of this line occurs at a
much lower order. For the factorial Levin-type transformation, the order kand execution time increase in the neighbourhood of
the branch cuts of 2F1and 2F0. It appears that both the order and execution times are nearly uniformly lower for the factorial
Levin-type transformation than the Drummond transformation for all three examples.
5 On the placement of the poles
It is important to be able to place the poles of the rational approximations of generalized hypergeometric functions. For a
rational approximation to an entire function, we should expect all of the poles to scatter to infinity with increasing order kin
the type (n+k, k). In the linear stability analysis of time-stepping schemes [34], it may also be important for the poles to live
in one particular half of the complex plane. For a rational approximation to an analytic function with a branch cut, we should
expect the poles of the rational approximation to be distributed along the branch cut or at the very least converge to it.
5.1 Pólya frequency functions
Pólya frequency functions have been used by Borghi and Weniger [28] in the case of 2F0(1,1;z)to locate the poles of both
the Drummond and factorial Levin-type transformation (with γ= 1) on the branch cut (0,∞). We begin our exploration with
a generalization of their result.
Lemma 5.1 (Richards [35] and Driver, Jordaan, and Martínez-Finkelstein [36]) .Letp≥q+ 1,α1, . . . , α p>0and
k1, . . . , k q+1∈N0. Then:
q+1Fpα1+k1, . . . , α q+1+kq+1
α1, . . . , α p;z
,
is a Pólya frequency function, and the associated terminating series:
q+2Fp−k, α 1+k1, . . . , α q+1+kq+1
α1, . . . , α p;z
,
has positive real roots.
For the particular choice of remainder estimate ωn= ∆sn=an+1, the denominators in both transformations of generalized
hypergeometric functions are also related to terminating generalized hypergeometric functions.
Lemma 5.2. The denominators in the Drummond transformation of the generalized hypergeometric series are:
∆k1
∆sn
=(−1)k(β1)n+1···(βq)n+1(1)n+1
zn+1(α1)n+1···(αp)n+1q+2Fp−k, n+ 2, β1+n+ 1, . . . , β q+n+ 1
α1+n+ 1, . . . , α p+n+ 1;1
z
. (36)16
Figure 4: The Drummond transformation for 1F1(α, β;z)withα= (5/4,)andβ= (3/2,).17
Figure 5: The factorial Levin-type transformation for 1F1(α, β;z)withα= (5/4,)andβ= (3/2,).18
Figure 6: The Drummond transformation for 2F1(α, β;z)withα= (1,−9/2)andβ= (−9/4,).19
Figure 7: The factorial Levin-type transformation for 2F1(α, β;z)withα= (1,−9/2)andβ= (−9/4,).20
Figure 8: The Drummond transformation for 2F0(α, β;z)withα= (1,3/2)andβ= ().21
Figure 9: The factorial Levin-type transformation for 2F0(α, β;z)withα= (1,3/2)andβ= ().22
Figure 10: The order k(top row) and execution time in seconds (bottom row) of the Drummond transformation for the three
generalized hypergeometric functions in Figures 4, 6, and 8.23
Figure 11: The order k(top row) and execution time in seconds (bottom row) of the factorial Levin-type transformation for the
three generalized hypergeometric functions in Figures 5, 7, and 9.24
The denominators in the factorial Levin-type transformation of the generalized hypergeometric series are:
∆k(n+γ)k−1
∆sn
=(−1)k(β1)n+1···(βq)n+1(1)n+1(n+γ)k−1
zn+1(α1)n+1···(αp)n+1
q+3Fp+1−k, k+n+γ−1, n+ 2, β1+n+ 1, . . . , β q+n+ 1
n+γ, α 1+n+ 1, . . . , α p+n+ 1;1
z
, (37)
and if γ= 2, then:
∆k(n+ 2) k−1
∆sn
=(−1)k(β1)n+1···(βq)n+1(1)n+k
zn+1(α1)n+1···(αp)n+1q+2Fp−k, k+n+ 1, β1+n+ 1, . . . , β q+n+ 1
α1+n+ 1, . . . , α p+n+ 1;1
z
.(38)
Proof. These formulæ follow from this representation of the binomial coefficient:
k
j
(−1)j=(−k)j
j!,
and the product of two Pochhammer symbols, (α)n+j+1= (α)n+1(α+n+ 1) j.
The next two results are a direct consequence of Lemmata 5.1 and 5.2.
Theorem 5.3. Letp > q + 1, letα1+n+ 1, . . . , α p−1+n+ 1>0, letαp∈ {− n,1−n, . . . , 1}, and let βi−αi∈N0for
i= 1, . . . , q . Then the Drummond transformations with ωn= ∆snhave positive real poles.
As examples, the Drummond transformations of 2F0(α,1;z)have positive real poles provided α+n+ 1>0, generalizing
the result of Borghi and Weniger [28, Lemma 6.1]. And, the Drummond transformations of 3F0(α, β,1;z)have positive real
poles provided α+n+ 1>0andβ+n+ 1>0, proving with conditions the observation of Li and Slevinsky [37, §3.3].
Note that Theorem 5.3 introduces the restriction p > q + 1, excluding the Gauss-like case p=q+ 1in addition to the entire
functions.
Theorem 5.4. Letp≥q+ 1,βi−αi∈N0fori= 1, . . . , q , and:
1. let n+γ >0, letα1+n+ 1, . . . , α p−1+n+ 1>0, and let αp∈ {− n,1−n, . . . , 1}; or,
2. ifγ= 2, letα1+n+ 1, . . . , α p−1+n+ 1>0, and let αp∈ {− n,1−n, . . . , k }.
Then the factorial Levin-type transformations with ωn= ∆snhave positive real poles.
As an example, the factorial Levin-type transformations of 2F0(α,1;z)have positive real poles provided α+n+ 1>0,
generalizing the result of Borghi and Weniger [28, Theorem 5.1].
5.2 Generalized eigenvalue problems
While Pólya frequency functions are a powerful theoretical tool, this theory does not characterize the placement of the poles; in
particular, due to the restriction p≥q+ 1, the theory of Pólya frequency functions does not apply to the rational approximants
to entire hypergeometric functions. Moreover, if p=q+ 1, we expect the reciprocal poles to live more precisely in (0,1]⊂
(0,∞). Therefore, we shall also consider how the recurrence relations from § 3 translate to banded generalized eigenvalue
problems for the reciprocal poles, ζ=z−1. Given that all three equations in Lemma 5.2 include a factor of ζn+1in the
denominators that cancels with an equal term in the numerators, all discussion in this section only concerns the nontrivial
reciprocal poles.
Viewing reciprocal poles as generalized eigenvalues is useful for determining the partial fraction decomposition of a rational
function. For example, with simple poles in hand, the residues may be computed by evaluating the numerator sequence at
the poles in complex arithmetic and the denominator sequence at the poles with dual-complex arithmetic and extracting the
derivatives through what is essentially forward-mode automatic differentiation.
LetA∈Rk×kandB∈Rk×kbe two square matrices. Let λ(A, B) ={ζ∈C: det( A−ζB) = 0}denote the generalized
eigenvalues of pencil (A, B), and let λ(A) =λ(A, I)denote the eigenvalues of A. Let ρ(A) = max
λ∈λ(A)|λ|be the spectral
radius of A.25
From Theorem 3.1, the denominators in the Drummond transformation with ωn= ∆snsatisfy:
0F0(z) : D(k+1)
n +D(k)
n=ζh
(n+k+ 2)D(k)
n+kD(k−1)
ni
,(39)
1F0(α;z) : ( α+n+k+ 1)D(k+1)
n + (α+n+ 2k+ 1)D(k)
n+kD(k−1)
n =ζh
(n+k+ 2)D(k)
n+kD(k−1)
ni
.(40)
We shall also require a bound on the roots of generalized Bessel polynomials [38]:
Y(δ)
k(z) =kX
j=0k
j
(k+δ+ 1) j)−z
2j
,
given by Do ˇcev [39] with a condition on δremoved by Saff and Varga [40, Theorems 5.1 & 5.2].
Lemma 5.5. Ifk+δ+ 1>0, then all the zeros of Y(δ)
k(z)lie in the closed disk:

z∈C:|z| ≤2
k+δ+ 1
.
Theorem 5.6. For the kreciprocal roots of D(k)
nin Eq. (39), we have:
1
n+k+ 1≤max
1≤j≤k|ζj| ≤1
n+ 2.
Proof. By Eq. (39), the reciprocal roots of D(k)
ncorrespond to the generalized eigenvalues of the pencil (A, B):

1 1
......
...1
1

| {z }
=:Av=ζ
n+ 2
1...
......
k−1n+k+ 1

| {z }
=:Bv,
and, since Bis invertible, the associated regular eigenvalue problem B−1A. Since:
tr(B−1A)
k≤ρ(B−1A),
we easily obtain the lower bound with B−1:
(B−1)i,j=

(−1)i−j(j)i−j
(n+j+ 1) i−j+1for i≥j,
0 otherwise .
Since:
tr(B−1A) =kX
i,j=1(B−⊤)i,jAi,j,
=k−1X
j=1
(B−1)j,j+ (B−1)j+1,j
+ (B−1)k,k,
=k−1X
j=11
n+j+ 1−j
(n+j+ 1) 2
+1
n+k+ 1,
=k−1X
j=1n+ 2
(n+j+ 1) 2+1
n+k+ 1,
= (n+ 2)1
n+ 2+1
n+k+ 1
+1
n+k+ 1=k
n+k+ 1.26
The upper bound follows from the representation of the denominators as generalized Bessel polynomials:
D(k)
n= (−1)k(1)n+1ζn+1Y(n+1−k)
k(2ζ).
Theorem 5.7. Ifα≤1andα+n+ 1>0, thekreciprocal roots of D(k)
nin Eq. (40) are all contained in the closed disk:
{ζ∈C:|ζ−1| ≤1}.
Proof. By Eq. (40), the reciprocal roots of D(k)
nare the generalized eigenvalues of the pencil (A, B):

α+n+ 1 α+n+ 1
1 α+n+ 3 α+n+ 2
...... α+n+k−1
k−1 α+n+ 2k−1

| {z }
=:Av=ζ
n+ 2
1...
......
k−1n+k+ 1

| {z }
=:Bv,
Shifting, η=ζ−1:

α−1α+n+ 1
......
...α+n+k−1
α+k−2
v=η
n+ 2
1...
......
k−1n+k+ 1
v,
Inverting Bas above and applying it to the matrix on the left, we find a matrix with almost all absolute row sums equal to 1,
and the last is less than or equal to 1only if α≤1. Specifically, let D=B−1(A−B)so that:
Di,j=

(−1)i−j(j)i−j(α−1)(n+ 1)
(n+j)i−j+2for j≤i,
n+i+α
n+i+1for j=i+ 1
0 otherwise .
Then, since ρ(D)≤ ∥D∥∞and:
iX
j=1(j)i−j(n+ 1)
(n+j)i−j+2=1
n+i+ 1,
we have:
∥D∥∞= max
1≤i≤k|n+i+α|
n+i+ 1(1−δk,i) +|α−1|
n+i+ 1
Since α <1andn+α+ 1≥0:
∥D∥∞= max
1≤i≤k(n+i+α)(1−δk,i) + 1−α
n+i+ 1
= max
1,1−α
n+k+ 1
= 1.
From Theorem 3.2 and Remark 3.6, the denominators in the factorial Levin-type transformation with ωn= ∆snandγ= 2
satisfy:
0F0(z) :Q(k+1)
n
(n+ 2k+ 1) 2+nQ(k)
n
(n+ 2k)(n+ 2k+ 2)−k(n+k)Q(k−1)
n
(n+ 2k)2=ζQ(k)
n,(41)
1F0(α;z) :(n+k+α+ 1)Q(k+1)
n
(n+ 2k+ 1) 2+1
2
1 +n(n+ 2α)
(n+ 2k)(n+ 2k+ 2)
Q(k)
n+(k−α)k(n+k)
(n+ 2k)2Q(k−1)
n =ζQ(k)
n.(42)27
Theorem 5.8. For the kreciprocal roots of Q(k)
nin Eq. (41), we have:
1
n+ 2k≤max
1≤j≤k|ζj| ≤1
n+k+ 1.
Proof. Eq. (41) defines a tridiagonal eigenvalue problem, and we take its trace for the lower bound:
|tr(A)|
k=1
kk−1X
j=0n
(n+ 2j)(n+ 2j+ 2)=1
n+ 2k≤ρ(A).
The upper bound follows from the representation of the denominators as generalized Bessel polynomials:
Q(k)
n= (−1)k(1)n+kζn+1Y(n)
k(2ζ).
Theorem 5.9. For−n−1< α < 1, thekreciprocal roots of Q(k)
nin Eq. (42) are all real and contained in (0,1).
Proof. Eq. (42) defines a real irreducible tridiagonal eigenvalue problem on which Gerschgorin’s theorem may be applied after
balancing 1- and∞-norms. The recurrence relation is solved by scaled Jacobi polynomials [1, §18.3]:
Q(k)
n=(−1)kk!(n+k)!
(α)n+k+1ζn+1P(α+n,−α)
k(1−2ζ),
whose roots lie in (−1,1).
Comparing Theorems 5.6 and 5.8, we observe that the rate at which the reciprocal roots of Q(k)
ntend to 0is characterized as
O(k−1), while the upper bound for the reciprocal roots of D(k)
nis not as informative. In this case, we have evidence that the
factorial Levin transformation is superior to the Drummond transformation given that the lower bound on the largest reciprocal
root of D(k)
nis the same as the upper bound of those of Q(k)
n.
Unfortunately, the roots of D(k)
nin Eq. (40) appear to be misplaced: instead of lying on the ray [1,∞), they appear to be
complex and as k→ ∞ tend to the boundary of the disk |ζ−1|= 1 from the right, which is equivalent to the line ℜz=1
2.
Figure 6 shows numerical evidence to suggest that this phenomenon carries over to 2F1as well. While Theorem 5.9 is an
unequivocal success, Figure 7 shows that this results does not carry over to 2F1.
6 Conclusion and Future Directions
Recurrence relations are derived for certain rational approximations to generalized hypergeometric functions coming from
the Drummond and factorial Levin-type sequence transformations. Numerical results illustrate that the latter are superior
in each of the three numerical representative classes. In the context of a package for numerically computing generalized
hypergeometric functions, these algorithms can only be seen as a special but important subset of the whole. A polyalgorithm
could include special cases for the parameters, use of the Maclaurin series, linear, quadratic, and cubic variable transformations,
contiguous relations [41], continued fractions, quadrature, and solution of the differential equation [1, §16.8.3], among many
other reasonable approaches. Assembling such a Frankenstein is beyond the scope of this work.
We will now identify a few avenues for future work. The instability in the original formulæ for the Drummond and factorial
Levin-type transformations is also present when summing sequences where the ratio of successive terms is irrational, such as
the Fox–Wright function [42, 43], defined by its Maclaurin series:
pΨq(a1, A1), . . . , (ap, Ap)
(b1, B1), . . . , (bq, Bq);z
=∞X
k=0Γ(a1+A1k)···Γ(ap+Apk)
Γ(b1+B1k)···Γ(bq+Bqk)zk
k!,
or the Riemann zeta function [1, §25.2], defined for ℜs >1by its infinite series:
ζ(s) =∞X
n=11
ns.28
It can be shown that the terms of these sequences still satisfy Theorem 2.1 with m= 1. While Theorems 3.1 and 3.2 do not
apply unless Ai, Bi∈Zin the former or s∈Zin the latter, it is worth exploring whether Eqs. (11), (12), (27), and (28) can be
adapted to this setting and provide more stable implementations.
The Drummond and Levin-type transformations have continuous analogues [19, 44–49], the latter of which is known as the
G(1)
ntransformation for approximating semi-infinite integrals. A particular case [50] of linear complexity recurrence relations
has been constructed for incomplete Bessel functions. The next logical step is a systematic construction and investigation based
on integrands satisfying first-order linear homogeneous differential equations with a rational variable coefficient.
Finally, hypergeometric functions of matrix argument have innumerable applications. Two particular ones include the cel-
ebrated φ-functions in exponential integrators [51] and computing Aα,log(A), among others [52]. For exp(A), unitarity
preserving approximations are non-negotiable in the time evolution of physical observables in quantum mechanics. It is well
known [53–55] that type- (k, k)Padé approximants to the exponential function are unitary, since each of its poles in the right-
half plane is paired with a root in the left-half plane, preserving the property that |[k/k]exp(z)|= 1forz∈iR. In [16, Example
1], Sidi shows that the factorial Levin-type transformation with ωn=an+1andγ= 2 ofexp(z)creates Padé approximants.
By Theorem 3.2 and Eq. (41), our recurrence for the main diagonal in the Padé table to the exponential is extremely efficient
on the imaginary axis:
µ0= 1, µ 1=1
2−z, µ k+1=1
4k+ 2 + z2µk,
R0= 1, R 1=R0+ 2zµ1, R k+1= [(4 k+ 2)Rk+z2Rk−1µk]µk+1.(43)
Figure 12 depicts the type- (k, k)Padé approximants to exp(z)on the imaginary axis. It is observed that convergence takes
places far from the origin and the scheme is stable in that divergence is not observed if the order is greater than necessary. For
100
 75
 50
 25
 0 25 50 75 1002.0
1.5
1.0
0.5
0.00.51.01.52.0exp(iz)
Type-(10, 10) Padé approximant
100
 75
 50
 25
 0 25 50 75 1002.0
1.5
1.0
0.5
0.00.51.01.52.0Type-(100, 100) Padé approximant
100
 75
 50
 25
 0 25 50 75 100
iz2.0
1.5
1.0
0.5
0.00.51.01.52.0exp(iz)
Type-(1,000, 1,000) Padé approximant
100
 75
 50
 25
 0 25 50 75 100
iz2.0
1.5
1.0
0.5
0.00.51.01.52.0Type-(10,000, 10,000) Padé approximant
Figure 12: The real part of unitarity-preserving type- (k, k)Padé approximants to exp(z)computed by Eq. (43).
a more complete appreciation, our algorithm approximates exp(109i)in double precision by:
[500,004,886/500,004,886] exp(109i) = 0 .837 887 181 360 9 + 0 .545 843 449 454 380 2i ,
a result with an absolute and relative error less than 6.43×10−12, and an error in unitarity less than 5.86×10−13.
According to Moler and Van Loan [56], while Padé approximation combined with scaling and squaring is the most effective
algorithm to compute the matrix exponential, most of the computational time is spent in the latter step since classical com-29
putation of Padé numerators and denominators suffers from significant rounding errors. With Eq. (43), this balance may be
reconsidered.
More stable algorithms for diagonals in the Padé table of other functions could conceivably be constructed by recurrence
relations analogous to those of the Drummond and factorial Levin-type transformations in this work.
Acknowledgments
We thank Nick Trefethen for a discussion on Padé approximation to ez. RMS is supported by the Natural Sciences and
Engineering Research Council of Canada, through a Discovery Grant (RGPIN-2017-05514).
References
[1] F. W. J. Olver, D. W. Lozier, R. F. Boisvert, and C. W. Clark, editors. NIST Handbook of Mathematical Functions .
Cambridge U. P., Cambridge, UK, 2010.
[2] M. Abramowitz and I. A. Stegun. Handbook of Mathematical Functions . Dover, New York, 1965.
[3] R. Forrey. Computing the hypergeometric function. J. Comput. Phys. , 137:79–100, 1997.
[4] W. Becken and P. Schmelcher. The analytic continuation of the Gaussian hypergeometric function 2F1(a, b;c;z)for
arbitrary parameters. J. Comp. Appl. Math. , 126:449–478, 2000.
[5] K. Muller. Computing the confluent hypergeometric function, M(a, b, x ).Numerische Mathematik , 90:179–196, 2001.
[6] N. Michel and M. V . Stoitsov. Fast computation of the Gauss hypergeometric function with all its parameters complex
with application to the Pöschl–Teller–Ginocchio potential wave functions. Comp. Phys. Commun. , 178:535–551, 2008.
[7] M. Colman, A. Cuyt, and J. van Deun. Validated computation of certain hypergeometric functions. ACM Trans. Math.
Software , 38:11:1–11:20, 2011.
[8] J. L. Willis. Acceleration of generalized hypergeometric functions through precise remainder asymptotics. Numer. Algor. ,
59:447–485, 2012.
[9] J. A. Doornik. Numerical evaluation of the Gauss hypergeometric function by power summations. Math. Comp. , 84:1813–
1833, 2015.
[10] J. W. Pearson, S. Olver, and M. A. Porter. Numerical methods for the computation of the confluent and Gauss hypergeo-
metric functions. Numer. Algor. , 74:821–866, 2017.
[11] S. Crespo, M. Fasondini, C. Klein, N. Stoilov, and C. Vallée. Multidomain spectral method for the Gauss hypergeometric
function. Numer. Algor. , 2019.
[12] F. Johansson. Computing hypergeometric functions rigorously. ACM Trans. Math. Software , 45:30:1–30:26, 2019.
[13] W. Bühring. An analytic continuation of the hypergeometric series. SIAM J. Math. Anal. , 18:884–889, 1987.
[14] W. Bühring. An analytic continuation formula for the generalized hypergeometric function. SIAM J. Math. Anal. ,
19:1249–1251, 1988.
[15] A. Iserles. A note on Padé approximations and generalized hypergeometric functions. BIT Numer. Math. , 19:543–545,
1979.
[16] A. Sidi. A new method for deriving Padé approximants for some hypergeometric functions. J. Comp. Appl. Math. ,
7:37–40, 1981.
[17] J. E. Drummond. A formula for accelerating the convergence of a general series. Bull. Austral. Math. Soc. , 6:69–74,
1972.
[18] D. Levin. Development of non-linear transformations for improving convergence of sequences. Int. J. Comput. Math. ,
B3:371–388, 1973.30
[19] D. Levin and A. Sidi. Two new classes of non-linear transformations for accelerating the convergence of infinite integrals
and series. Appl. Math. Comput. , 9:175–215, 1981.
[20] E. J. Weniger. Nonlinear sequence transformations for the acceleration of convergence and the summation of divergent
series. Comput. Phys. Rep. , 10:189–371, 1989.
[21] H. H. H. Homeier. Scalar Levin-type sequence transformations. J. Comp. Appl. Math. , 122:81–147, 2000.
[22] A. Sidi. Practical Extrapolation Methods: Theory and Applications . Cambridge U. P., Cambridge, 2003.
[23] R. M. Slevinsky. https://github.com/JuliaMath/HypergeometricFunctions.jl .GitHub , 2018.
[24] Y . L. Luke. On economic representations of transcendental functions. J. Math. and Phys. , 38:279–294, 1960.
[25] J. L. Fields. Rational approximations to generalized hypergeometric functions. Math. Comp. , 19:606–624, 1965.
[26] R. Shelef. New numerical quadrature formulas for Laplace transform inversion by Bromwich’s integral. Master’s thesis,
Technion–Israel Institute of Technology, 1987.
[27] H. H. H. Homeier and E. J. Weniger. On remainder estimates for Levin-type sequence transformations. Comput. Phys.
Commun. , 92:1–10, 1995.
[28] R. Borghi and E. J. Weniger. Convergence analysis of the summation of the factorially divergent Euler series by Padé
approximants and the delta transformation. Appl. Num. Math. , 94:149–178, 2015.
[29] Y . Nakatsukasa, O. Sète, and L. N. Trefethen. The AAA algorithm for rational approximation. SIAM J. Sci. Comput. ,
40:A1494–A1522, 2018.
[30] W. G. Horner. A new method of solving numerical equations of all orders, by continuous approximation. Phil. Trans.
Roy. Soc. , 109:308–335, 1819.
[31] L. Fousse, G. Hanrot, V . Lefèvre, P. Pélissier, and P. Zimmermann. MPFR: A multiple-precision binary floating-point
library with correct rounding. ACM Trans. Math. Software , 33:13:1–13:15, 2007.
[32] F. Johansson. Arb: efficient arbitrary-precision midpoint-radius interval arithmetic. IEEE Trans. Comp. , 66:1281–1292,
2017.
[33] D. A. Smith and W. F. Ford. Acceleration of linear and logarithmic convergence. SIAM J. Numer. Anal. , 16:223–240,
1979.
[34] A. Iserles. A First Course in the Numerical Analysis of Differential Equations . Cambridge Texts in Applied Mathematics.
Cambridge University Press, second edition, 2009.
[35] D. St. P. Richards. Totally positive kernels, Pólya frequency functions, and generalized hypergeometric series. Linear
Algebra Appl. , 137/138:467–478, 1990.
[36] K. Driver, K. Jordaan, and A. Martínez-Finkelshtein. Pólya frequency sequences and real zeros of some 3F2polynomials.
J. Math. Anal. Appl. , 332:1045–1055, 2007.
[37] Y . Li and R. M. Slevinsky. Fast and accurate algorithms for the computation of spherically symmetric nonlocal diffusion
operators on lattices. J. Comp. Phys. , 397:108870, 2019.
[38] H. L. Krall and O. Frink. A new class of orthogonal polynomials: The Bessel polynomials. Trans. Amer. Math. Soc. ,
65:100–115, 1949.
[39] K. Do ˇcev. On the generalized Bessel polynomials. Bulgar. Akad. Nauk. Izv. Mat. Inst. , 6:89–94, 1962.
[40] E. B. Saff and R. S. Varga. Zero-free parabolic regions for sequences of polynomials. SIAM J. Math. Anal. , 7:344–357,
1976.
[41] J. Wimp. Recursion formulae for hypergeometric functions. Math. Comp. , 22:363–373, 1968.
[42] C. Fox. The asymptotic expansion of generalized hypergeometric functions. Proc. Lond. Math. Soc. , 27:389–400, 1928.
[43] E. M. Wright. The asymptotic expansion of the generalized hypergeometric function. J. London Math. Soc. , 10:286–293,
1935.31
[44] H. L. Gray and S. Wang. A new method for approximating improper integrals. SIAM J. Numer. Anal. , 29:271–283, 1992.
[45] C. Brezinski and M. Redivo-Zaglia. Extensions of Drummond’s process for convergence acceleration. Appl. Num. Math. ,
60:1231–1241, 2010.
[46] M. Slevinsky and H. Safouhi. Numerical treatment of a twisted tail using extrapolation methods. Numer. Algor. , 48:301–
316, 2008.
[47] R. M. Slevinsky and H. Safouhi. The SandGtransformations for computing three-center nuclear attraction integrals.
Int. J. Quant. Chem. , 109:1741–1747, 2009.
[48] R. M. Slevinsky and H. Safouhi. A recursive algorithm for the Gtransformation and accurate computation of incomplete
Bessel functions. Appl. Num. Math. , 60:1411–1417, 2010.
[49] P. Gaudreau, R. M. Slevinsky, and H. Safouhi. Computation of tail probability distributions via extrapolation methods
and connection with rational and Padé approximants. SIAM J. Sci. Comput. , 34:B65–B85, 2012.
[50] R. M. Slevinsky and H. Safouhi. A recursive algorithm for an efficient and accurate computation of incomplete Bessel
functions. Numer. Algor. , 92:973–983, 2023.
[51] M. Hochbruck and A. Ostermann. Exponential integrators. Acta Numerica , 19:209–286, 2010.
[52] N. Hale, N. J. Higham, and L. N. Trefethen. Computing Aα,log(A)and related matrix functions by contour integrals.
SIAM J. Numer. Anal. , 46:2505–2523, 2008.
[53] G. Birkhoff and R. S. Varga. Discretization errors for well-set Cauchy problems. I. J. Math. and Phys. , 44:1–23, 1965.
[54] B. L. Ehle. A-stable methods and Padé approximations to the exponential. SIAM J. Math. Anal. , 4:671–680, 1973.
[55] E. B. Saff and R. S. Varga. On the zeros and poles of Padé approximants to ez.Numer. Math. , 25:1–14, 1975.
[56] C. Moler and C. Van Loan. Nineteen dubious ways to compute the exponential of a matrix. SIAM Rev. , 20:801–836,
1978.