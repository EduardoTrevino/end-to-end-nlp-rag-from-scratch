M-SIDH and MD-SIDH: countering SIDH
attacks by masking information
Tako Boris Fouotsa[0000âˆ’0003âˆ’1821âˆ’8406]1, Tomoki Moriya[0000âˆ’0002âˆ’7845âˆ’4737]2,
and Christophe Petit[0000âˆ’0003âˆ’3482âˆ’6743]3 ,4
1LASEC-EPFL, Switzerland
tako.fouotsa@epfl.ch
2The University of Tokyo, Japan
tomoki_moriya@mist.i.u-tokyo.ac.jp
3UniversitÃ© Libre de Bruxelles, Belgium
4University of Birmingham, UK
Christophe.Petit@ulb.be
Abstract. The SIDH protocol is an isogeny-based key exchange proto-
col using supersingular isogenies, designed by Jao and De Feo in 2011.
The protocol underlies the SIKE algorithm which advanced to the fourth
round ofNISTâ€™s post-quantum standardizationproject in May 2022.The
algorithm was considered very promising: indeed the most significant at-
tacks against SIDH were meet-in-the-middle variants with exponential
complexity, and torsion point attacks which only applied to unbalanced
parameters (and in particular, not to SIKE).
This security picture dramatically changed in August 2022 with new
attacks by Castryck-Decru, Maino-Martindale and Robert. Like prior
attacks on unbalanced versions, these new attacks exploit torsion point
information provided in the SIDH protocol. Crucially however, the new
attacks embed the isogeny problem into a similar isogeny problem in a
higher dimension to also affect the balanced parameters. As a result of
these works, the SIKE algorithm is now fully broken both in theory and
in practice.
Given the considerable interest attracted by SIKE and related protocols
in recent years, it is natural to seek countermeasures to the new attacks.
In this paper, we introduce two such countermeasures based on partially
hiding the isogeny degrees and torsion point information in the SIDH
protocol. We present a preliminary analysis of the resulting schemes in-
cludingnon-trivialgeneralizationsofpriorattacks.Basedonthisanalysis
we suggest parameters for our M-SIDH variant with public key sizes of
4434, 7037 and 9750 bytes respectively for NIST security levels 1, 3, 5.
Keywords: Isogenies Â·SIDH attacks Â·Countermeasures Â·M-SIDH Â·
MD-SIDH.
1 Introduction
In 1994, Peter Shor [35] described a polynomial quantum algorithm to solve
the integer factorization problem and the discrete logarithm problem. This im-2 T. B. Fouotsa, T. Moriya and C. Petit
plies that the widely deployed cryptographic protocols we use today would be-
come vulnerable in presence of a large-scale quantum computer. To mitigate this
threat, research on post-quantum cryptography , namely cryptographic protocols
that will hopefully remain secure against both classical and quantum comput-
ers, has considerably developed in the last two decades. Several standardization
competitions were initiated, among which the NIST PQC [29]. Many new can-
didates for post-quantum hard problems have been suggested to date based on
lattices, codes, isogenies , multivariate systems of equations, and other problems.
Isogenies are maps between elliptic curves. For cryptographic applications,
we restrict ourselves to curves defined over finite fields Fq. When there exists an
isogeny Ï•:Eâ†’Eâ€², we say the elliptic curves EandEâ€²areisogenous . There
are infinitely many isogenies connecting two isogenous elliptic curves. The pure
isogeny problem is stated as follows.
Problem 1. Given two isogenous elliptic curves EandEâ€², compute an isogeny
from EtoEâ€².
An isogeny from a curve Eto itself is called an endomorphism of E, and the set
of all the endomorphisms of E(together with the 0map) is called the endomor-
phism ring of E.
Over finite fields, there are two categories of elliptic curves, namely ordinary
elliptic curves andsupersingular elliptic curves . The endomorphism ring of any
ordinary curve is an order in a quadratic imaginary field (hence is commutative),
whereas the endomorphism ring of a supersingular curve is a maximal order in
a quaternion algebra (hence is non-commutative). Isogenies connect ordinary
curves between themselves and supersingular curves between themselves.
There is a straightforward adaptation of the well-known Diffie-Hellman key
exchange protocol to isogenies in the ordinary/commutative case. This is in fact
what is done in isogeny based schemes like CRS [14,34], CSIDH [8], OSIDH [10]
and derivatives. The high level idea is as follows: there is a starting curve E0.
Alice selects a secret isogeny Ï•A:E0â†’EA, and Bob selects a secret isogeny
Ï•B:E0â†’EB. Both parties exchange EAandEB. Each party recomputes
their secret isogeny from the other partyâ€™s public curve. Since the isogenies â€are
commutativeâ€, they get the same end curve EAB(up to isomorphism) whose
j-invariant is used as the shared secret. Note that the isogeny EAâ†’EAB
computed by Alice is not exactly the isogeny Ï•Asince they do not have the
same domain and codomain. This isogeny is in general denoted by Ï•â€²
A. Similarly,
Bobâ€™s isogeny is also denoted by Ï•â€²
B. This is illustrated in Figure 1 where we
have Ï•â€²
Aâ—¦Ï•B=Ï•â€²
Bâ—¦Ï•A.
When it comes to using supersingular curves, designing a Diffie-Hellman type
key exchange is less straightforward because their endomorphism rings are non-
commutative. In 2011, Jao and De Feo [24] had a brilliant idea on how to obtain
a commutative diagram in the supersingular case. To achieve this goal:
1. One fixes the respective degrees AandBof the isogenies Ï•AandÏ•B, with
AandBcoprime;
2. Alice reveals the images of a basis of the B-torsion of E0(that is E0[B]),
and Bob reveals the image of a basis of the A-torsion of E0(that is E0[A]).M-SIDH and MD-SIDH: countering SIDH attacks by masking information 3
E0 EA
EB EABÏ•A
Ï•â€²
BÏ•B
Ï•â€²
A
Fig. 1.Generic commutative isogeny key exchange.
This idea led to the Supersingular Isogeny Diffie-Hellman protocol (SIDH),
which has received a lot of attention in the last decade. This protocol and other
isogeny-based schemes are attractive for their very compact secret and public
keys.ThishasbeenoneofthemostvaluableadvantagesofSIKE,aKeyEncapsu-
lation Mechanism (KEM) derived from SIDH, compared to other post-quantum
KEMs. SIKE became widely regarded as a promising post-quantum candidate
for standardization, and in particular the algorithm made it to the 4th round of
the NIST competition.
With the exception of the CGL hash function [9] and GPS signatures [21],
most isogeny-based protocols in the literature do not directly rely on the pure
isogenyproblem,butonsomevariantsofthisproblem.InthecaseofSIDH/SIKE,
an attacker is provided with additional non-trivial information: the degree of the
isogeny and the images of torsion points. More precisely, the security of SIDH
relies on the following problem.
Problem 2. LetE0beasupersingularcurvedefinedover Fp2withp=ABâˆ’1.Set
E0[A] =âŸ¨P, QâŸ©. Let Ï•:E0â†’Eâ€²be an isogeny of degree Band let Pâ€²=Ï•(P),
Qâ€²=Ï•(Q). Given E0,P,Q,Eâ€²,Pâ€²andQâ€², compute the isogeny Ï•.
Furthermore, in SIDH/SIKE, the starting curve E0is special: its endomor-
phism ring is publicly available. In 2017, Petit [31] exploited the knowledge of
the endomorphism ring of E0and the torsion point information to design attacks
that recover the secret isogeny in polynomial time assuming that Aâ‰ªB. After
a recent improvement [32], the attack still required imbalanced AandB, hence
it does not apply to SIDH where Aâ‰ˆB.
In July 2022, Castryck and Decru [7] described devastating attacks on SIDH
that recovered the secret key in SIDH and SIKE, instantiated with the NIST
parameters, in a few hours. The attacks were also developed in a concurrent
work by Maino and Martindale [26]. Various follow-up works by other authors
quickly improved the practical runtime time to minutes and seconds, and clari-
fied the asymptotic complexities. The best attacks on balanced SIDH parameters
had suddenly gone from exponential time to subexponential time, with a fur-
ther reduction to polynomial time complexity when the endomorphism ring of
the starting curve is available (as was the case in SIKE). Things could only get
worse for SIDH, and a few days later they did, when Robert described an im-4 T. B. Fouotsa, T. Moriya and C. Petit
proved attack with polynomial time complexity working for arbitrary starting
curves [33].
We note that like Petitâ€™s attacks before them, the Castryck-Decru-Maino-
Martindale-Robert attacks exploit knowledge of both torsion point information
and the degree of the secret isogeny.
WhiletheCastryck-Decru-Maino-Martindale-Robertattacksconstituteaclear
cryptanalysis breakthrough on a flagship isogeny-based cryptographic protocol,
they do not apply to other isogeny-based schemes in which no torsion point
information is revealed: CRS [14,34], CSIDH [8] and CSIDH-based signatures
(SeaSign [15], SCI-FiSh [3], ...), CGL [9], GPS [21], SQISign [17], and many
more. The new attacks do not imply that the whole of isogeny-based cryptogra-
phy is insecure, but only that the field is getting mature! In particular, a natural
question now is whether one can find countermeasures against the Castryck-
Decru-Maino-Martindale-Robert attacks and repair the SIDH protocol.
Contributions1. In this paper, we propose and analyze two countermeasure can-
didates to the Castryck-Decru attack: Masked-Degree SIDH (MD-SIDH) and
Masked torsion points SIDH (M-SIDH).
The main idea in MD-SIDH is to mask the degree of the secret isogeny:
the degrees AandBof the secret isogenies in SIDH are no longer fixed, but
uniformly random divisors of AandBrespectively. To prevent the degree from
being recovered by a pairing computation and some discrete logarithms in a
group of smooth order, the images of the torsion points are scaled by a random
integer.
The main idea in M-SIDH is to keep the degrees of the secret isogenies fixed
as in SIDH, and mask only the torsion point information: the images of the
torsion points are scaled by a random integer. To prevent an efficient recovery
of the secret scalar used in M-SIDH (using pairings and discrete logarithms), we
set the isogeny degrees AandBto have tâ‰¥2Î»distinct prime divisors, so that
the scalar cannot be recovered despite the fact that its square modulo AorBis
known.
We perform a thorough security analysis of the two countermeasures, includ-
ing non-trivial extensions of prior attacks. In particular, we give an expected
polynomial time attack on the M-SIDH variant when the starting curve has a
known small endomorphism, and a reduction from any MD-SIDH instance to
an M-SIDH instance. We also show that isogeny degrees in the M-SIDH variant
must have at least 2Î»distinct factors, where Î»is the security parameter. Finally,
we provide non-trivial variants of adaptive attacks on SIDH, including the GPST
attack and the Fouotsa-Petit attack.
Based on our analysis, the M-SIDH variant is the most promising one as it
features smaller keys at identical security levels. The variant must be used with
a randomly generated starting curve to avert the attack mentioned above (note
that this is not an issue in a key encapsulation mechanism as the starting curve
may be constructed by the key generation algorithm). Our analysis suggests
1This paper is an extended merge of the preprints [18] and [27]M-SIDH and MD-SIDH: countering SIDH attacks by masking information 5
that public key sizes of 4434, 7037 and 9750 bytes are sufficient to reach AES-
128, AES-192 and AES-256 security levels (NIST security levels 1, 3, 5), and
asymptotically public keys should be a factor O(logÎ»)larger than in SIDH.
1.1 Outline.
In Section 2 we briefly present the SIDH protocol and discuss attacks on SIDH.
In Section 3 we describe our two constructions Masked-degree SIDH and Masked
SIDH(M-SIDH).InSections4,5and6,wedoasecurityanalysisofbothschemes
and in Section 7 we suggest parameters. We conclude the paper in Section 8.
2 The SIDH protocol and attacks
The Supersingular Isogeny Diffie-Hellman protocol (SIDH) is a key exchange
protocol designed by Jao and De Feo [24], which underlies the SIKE submission
to NIST post-quantum cryptography project [23]. Interest in the SIDH protocol
grewsteadilysince2011,butpassivecryptanalyticsuccessremainedlimiteduntil
new attacks fully broke it in August 2022.
2.1 The SIDH protocol
TheSIDHprotocolisaDiffie-Hellman-likekeyexchangeschemethatusestorsion
point information to complete a (pseudo) commutative diagram:
(E0, PA, QA, PB, QB)
//(EA, Ï•A(PB), Ï•A(QB))

(EB, Ï•B(PA), Ï•B(QA)) //EABâˆ¼=EBA
The precise scheme is as follows:
Public parameter: LetE0betheellipticcurveof j-invariant 1728.Setaprime
pasp= 2eA3eBâˆ’1. Let PAandQA(resp. PBandQB) be points generating
E0[2eA]âˆ¼=(Z/2eAZ)2(resp. E0[3eB]âˆ¼=(Z/3eBZ)2).
Public key (Alice): Alice first generates a random value kAâˆˆ(Z/2eAZ)Ã—as
her secret key. Let RA=PA+kAQA. Alice computes an isogeny Ï•A:E0â†’
EA:=E0/âŸ¨RAâŸ©and image points Ï•A(PB), Ï•A(QB).Alice sends to Bob EA
and these image points as a public key.
Public key (Bob): Bob first generates a random value kBâˆˆ(Z/3eBZ)Ã—as
his secret key. Let RB=PB+kBQB. Bob computes an isogeny Ï•B:E0â†’
EB:=E0/âŸ¨RBâŸ©and image points Ï•A(PB), Ï•A(QB).Bob sends to Alice EB
and these image points as a public key. Let kBbe his secret key.
Shared key: LetRâ€²
A=Ï•B(PA)+kAÏ•B(QA),andlet Râ€²
B=Ï•A(PB)+kBÏ•A(QB).
Alice computes EAB:=EB/âŸ¨Râ€²
AâŸ©, and Bob computes an isogeny EBA:=
EA/âŸ¨Râ€²
BâŸ©.The value j(EAB) =j(EBA)is the shared key.
The SIDH protocol is the basis of the SIKE algorithm, which was selected
for Round 4 of NIST post-quantum standardization project in June 2022.6 T. B. Fouotsa, T. Moriya and C. Petit
2.2 Cryptanalysis attempts and successes
A natural problem to consider in the cryptanalysis of SIDH is the isogeny with
torsion problem: Problem 2 with A= 2eAandB= 3eB. One approach to solve
this problem is to entirely ignore the torsion point information, and recover
the isogeny with some advanced brute force strategy such as a meet-in-the-
middle algorithm or Van Oorschot-Wienerâ€™s algorithm [36]. These approaches
have guided the parameter selection of SIKE submission to NIST [23].
The first passive attacks exploiting torsion point information2were intro-
duced by Petit [31]. The key idea in his attack is to consider an endomorphism
Î¨ofEâ€²of the form
Ïˆ=d+Ï•â—¦Î¸â—¦Ë†Ï•
where dâˆˆZandÎ¸is a trace 0 non scalar endomorphism of E0such that
degÏˆ=d2+B2degÎ¸
divides A. Provided such parameters, one can use torsion point information on
Ï•to deduce torsion point information on Ïˆ, then use this information to recover
kerÏˆvia a (smooth order hence efficient) discrete logarithm computation, and
finally deduce Ï•. Note that this strategy requires at least partial knowledge of
the endomorphism ring of E0(forÎ¸) and moreover it only works if Ais large
enoughcomparedto B.(Inparticular,itdoesnotworkwhen Aâ‰ˆBasinSIKE.)
Improvementsinlaterworkincreasedtherangeofparametersvulnerabletothese
attacks but they did not fundamentally change these limitations [5,32].
In August 2022, Castryck and Decru [7] (and independently Maino and Mar-
tindale [26]) introduced new powerful attacks against SIDH, with polynomial
time complexity when the endomorphism ring of E0is known and subexpo-
nential complexity in general. Extensions by Robert [33] further reduced the
complexity to polynomial time in the general case. In a sense, these attacks can
be seen as generalizations of previous torsion point attacks3, but with a key ad-
ditional insight: they crucially embed the SIDH isogeny problem into a higher
dimensional isogeny problem, where more endomorphisms are readily available.
In a nutshell, Robertâ€™s attack considers the genus 8 Abelian variety E4
0Ã—Eâ€²4,
and its endomorphism
Î¨=
Î±0Ë†Î¦
âˆ’Î¦Ë†Î±â€²
,
2Torsion point information was previously used in active attacks against SIDH [20]
and prompted the inclusion of a CCA transform (a variant of Fujisaki-Okamoto
transform) within SIKE.
3The original Castryck-Decruâ€™s paper did not initially make a connection with prior
torsion point attacks, but this connection then rapidly emerged and is clearly de-
scribed in [26,33]M-SIDH and MD-SIDH: countering SIDH attacks by masking information 7
where Î¦is the natural extension of Ï•onE4
0,Ë†Î¦is its dual, and Î±0andÎ±â€²are the
endomorphisms on E4
0andEâ€²4with action given by the matrix
M=ï£«
ï£¬ï£¬ï£­a0a1a2a3
âˆ’a1a0âˆ’a4a3
âˆ’a3a4âˆ’a1a2
âˆ’a4âˆ’a3a2a1ï£¶
ï£·ï£·ï£¸
with a0, a1, a2, a3such that a:=a2
0+a2
1+a2
2+a2
3=Aâˆ’B. We then have
Î¨Ë†Î¨=AI8
where Ë†Î¨=
Ë†Î±0âˆ’Ë†Î¦
Î¦ Î±â€²
is the dual of Î¨, i.e., Î¨is an endomorphism of degree A.
As in previous torsion point attacks, one can evaluate Î¨on the Atorsion using
torsion point information provided in the SIDH problem. One can then compute
Î¨and finally deduce Ï•.
From now on we will refer to these attacks as â€œthe CD-MM-R attacksâ€. Com-
pared to previous torsion point attacks, these new attacks do not require any
knowledge on the endomorphism ring of the starting curve, and work whenever
Aâ‰¥B. One can further improve this to Aâ‰¥âˆš
Bas in the â€œdual isogeny variantâ€
of [32]: let a:=A2âˆ’B; recover the first halves of the endomorphisms Î¨and Ë†Î¨
using torsion point information; and finally deduce the whole of Î¨andÏ•[33].
Whiletheydonotrequireanyknowledgeof End(E0),thenewattacksstilluse
torsion point information and general SIDH parameters, including the isogeny
degrees. In the following section, we describe two countermeasures: the first one
consists in making the torsion point images while the second one consists in
masking the isogeny degrees.
3 Masked SIDH variants
Recall that the CD-MM-R attack requires two main ingredients:
1. the degree Aof the secret supersingular isogeny Ï•:E0â†’E;
2. the images Ï•(P),Ï•(Q)of a torsion basis (P, Q)of the B-torsion E0[B]where
Bis an integer coprime to Asuch that B > A.
The countermeasures we suggest here consist in masking each of the above.
Firstly, we suggest Masked torsion points SIDH or M-SIDH for short, in which
one masks the torsion point images by scaling them with a random scalar. Sec-
ondly, we suggest Masked-degree SIDH or MD-SIDH for short, in which the
isogenies computed do not have a fixed degree.
In the rest of this paper, we will often use the following lemma.
Lemma 3. LetÏ•:Eâˆ’â†’Eâ€²be an isogeny of unknown degree dand let Bbe a
smooth integer coprime to dsuch that E[B]âŠ‚E(Fp2). Set E[B] =âŸ¨P, QâŸ©. Then
given P, Q,Ï•(P)andÏ•(Q), there exists a polynomial time algorithm to recover
dmodB.8 T. B. Fouotsa, T. Moriya and C. Petit
Proof.One computes the Weil pairing values eB(P, Q)andeB(Ï•(P), Ï•(Q)) =
eB(P, Q)degÏ•, then one solves a discrete logarithm instance between both quan-
tities to recover dmodB. Since E[B]âŠ‚E(Fp2), the pairing computations run
in polynomial time. Since Bis smooth, then using the Pohlig-Hellman algorithm
the discrete logarithm computation runs in polynomial time as well. âŠ“ âŠ”
3.1 Masked torsion points variant
The aim here is to instantiate SIDH such that the direct images Ï•(P),Ï•(Q)of
PandQare not available to adversaries, but the key exchange still succeeds:
this means that when given a point RâˆˆE0[B], one should be able to compute
a generator of the group Ï•(âŸ¨RâŸ©).
To achieve this goal, the images Ï•(P),Ï•(Q)ofPandQare scaled by a
random integer Î±âˆˆZ/BZÃ—. That is instead of revealing Ï•(P),Ï•(Q), one reveals
[Î±]Ï•(P),[Î±]Ï•(Q). Note that since the degree of the secret isogeny Ï•is fixed, one
can recover Î±2degÏ•by applying Lemma 3, from which one derives Î±2modB.
Taking a square root Î±0ofÎ±2, one recovers [Î±Î±âˆ’1
0]Ï•(P)and[Î±Î±âˆ’1
0]Ï•(Q)where
(Î±Î±âˆ’1
0)2= 1 mod B. Hence one can sample Î±directly from Âµ2(B)where
Âµ2(N) ={xâˆˆZ/NZ|x2= 1 mod N}.
Note that for the scheme to be secure against the CD-MM-R attack, it is nec-
essary that an attacker should not be able to recover the scalar Î±. The isogeny
degrees are chosen such that there is an exponential number of square roots of
1modulo B. This leads to the following variant of SIDH: M-SIDH.
Public parameter: LetÎ»be the security parameter and let t=t(Î»)âˆˆN
be an integer depending on Î». Let p=ABfâˆ’1be a prime such that
A=Qt
i=1â„“iandB=Qt
i=1qiare coprime integers, â„“i, qiare distinct small
primes, Aâ‰ˆBâ‰ˆâˆšpandfis a small cofactor. Let E0be a supersingular
curve defined over Fp2. Set E0[A] =âŸ¨PA, QAâŸ©andE0[B] =âŸ¨PB, QBâŸ©. The
public parameters are E0,p,A,B,PA,QA,PB,QB.
Public key (Alice): Alice samples uniformly at random two integers Î±anda
from Âµ2(B)andZ/AZrespectively. She computes the cyclic isogeny Ï•A:
E0â†’EA=E0/âŸ¨PA+ [a]QAâŸ©. Her public key is the tuple
pkA= (EA,[Î±]Ï•A(PB),[Î±]Ï•A(QB))and her secret key is skA=a. The inte-
gerÎ±is deleted.
Public key (Bob): Analogously, Bob samples uniformly at random two inte-
gersÎ²andbfrom Âµ(A)andZ/BZrespectively. His public key is pkB=
(EB,[Î²]Ï•B(PA),[Î²]Ï•B(QA))where Ï•B:E0â†’EB=E0/âŸ¨PB+ [b]QBâŸ©and
his secret key is skB=b. The integer Î²is deleted.
Shared key: Upon receiving Bobâ€™s public key (EB, Ra, Sa), Alice checks that
eA(Ra, Sa) =eA(PA, QA)B, if not she aborts. She computes the isogeny
Ï•â€²
A:EBâ†’EBA=EB/âŸ¨Ra+ [a]SaâŸ©. Her shared key is j(EBA). Similarly,
upon receiving (EA, Rb, Sb), Bob checks that eB(Rb, Sb) =eB(PB, QB)A, ifM-SIDH and MD-SIDH: countering SIDH attacks by masking information 9
nothe aborts. Hecomputes theisogeny Ï•â€²
B:EAâ†’EAB=EA/âŸ¨Rb+ [b]SbâŸ©.
His shared key is j(EAB).
The problem underlying the security of M-SIDH is stated as follows.
Problem 4. LetA=â„“1Â·Â·Â·â„“tand let B=q1Â·Â·Â·qtbe two smooth coprime inte-
gers, let fbe a small cofactor such that p=ABfâˆ’1is a prime, with Aâ‰ˆB.
LetE0/Fp2be a supersingular elliptic curve such that #E0(Fp2) = ( p+ 1)2=
(ABf )2, setE0[B] =âŸ¨P, QâŸ©. Let Ï•:E0â†’Ebe a uniformly random A-isogeny
and let Î±be a uniformly random element of Âµ2(B).
Given E0, P, Q, E A, Pâ€²= [Î±]Ï•(P), Qâ€²= [Î±]Ï•(Q), compute Ï•.
It is immediate that Problem 4 is not hard for too small values of t. Recall
that we want 1to have an exponential number of square roots modulo Aand
modulo B. At first, one may be tempted to set t=Î»so that there are about 2Î»
square roots of 1modulo Aand modulo B. But, as we will see in Section 4, this
is not secure and tneeds to be larger.
The main difference between Problem 4 and Problem 2 is that in Problem 4
torsion point images are only provided up to a scalar multiple (more precisely, a
square root of unity). When trying to apply Robertâ€™s attack, the endomorphism
Î¨appearing in this attack can no longer be evaluated exactly and its kernel
can no longer be computed directly. The same holds for the attacks described in
Castryck-Decru and Maino-Martindale papers.
3.2 Masked-degree variant
Rather than masking the torsion points as described in the previous section,
we suggest a second countermeasure where one masks the degree of the secret
isogeny.
Set the prime pto be of the form p=ABfâˆ’1where AandBare two
smooth coprime integers, and fis a small cofactor. Alice will use cyclic isogenies
of degree Aâ€²dividing Aand Bob will use cyclic isogenies of degree Bâ€²dividing
B. In an SIDH prime A=â„“eA
AandB=â„“eB
B, hence AandBhave only eA+ 1
andeB+ 1divisors respectively. For this reason, one needs to move away from
SIDHprimesanduseCSIDH-styleprimeswith A=â„“a1
1Â·Â·Â·â„“at
tandB=qb1
1Â·Â·Â·qbt
t
where t, as well as the ais and the bis, depend on the security parameter Î».
To generate her public key, Alice samples a random degree Aâ€²(divisor of
A) for her secret isogeny, samples a random point RAâˆˆE0[Aâ€²], computes the
Aâ€²-isogeny Ï•A:E0â†’EA:=E0/âŸ¨RAâŸ©andÏ•A(PB),Ï•A(QB)where E0[B] =
âŸ¨PB, QBâŸ©. But, by Lemma 3, any adversary can recover Aâ€²= deg Ï•A. In order
to avoid this, Alice also generates a uniformly random integer Î±âˆˆZ/BZÃ—and
outputs (EA,[Î±]Ï•A(PB),[Î±]Ï•A(QB))as her public key. More precisely, Masked-
degree SIDH (MD-SIDH) is as follows:
Public parameter: LetE0be a supersingular elliptic curve. Let t=t(Î»)âˆˆN
be an integer depending4onÎ». Let A=â„“a1
1Â·Â·Â·â„“at
tandB=qb1
1Â·Â·Â·qbt
tbe
4Note that we use the same notation t=t(Î»)for M-SIDH and MD-SIDH. It will
always be clear from the context whether we are referring to M-SIDH or MD-SIDH.10 T. B. Fouotsa, T. Moriya and C. Petit
two smooth coprime integers such that p=ABfâˆ’1is a prime (where fis
a small cofactor). Set PAandQA(resp. PBandQB) be points generating
E0[A] =âŸ¨PA, QAâŸ©andE0[B] =âŸ¨PB, QBâŸ©.
Public key (Alice): Alice samples a uniformly random divisor Aâ€²ofAand a
random point RAâˆˆE0[Aâ€²]. Her secret key is skA=RA. She computes the
isogeny Ï•A:E0â†’EA:=E0/âŸ¨RAâŸ©together with Ï•A(PB)andÏ•A(QB).
She samples a uniformly random integer5Î±âˆˆZ/BZÃ—and her public key is
pkA= ([Î±]Ï•A(PB),[Î±]Ï•A(QB)).
Public key (Bob): Bob samples a uniformly random divisor Bâ€²ofBand a
random point RBâˆˆE0[Bâ€²]. His secret key is skB=RB. He computes the
isogeny Ï•B:E0â†’EB:=E0/âŸ¨RBâŸ©together with Ï•B(PA)andÏ•B(QA).
He samples a uniformly random integer Î²âˆˆZ/AZÃ—and his public key is
pkB= ([Î²]Ï•B(PA),[Î²]Ï•B(QA)).
Shared key: From [Î²]Ï•B(PA)and[Î²]Ï•B(QA),Alicerecovers âŸ¨Râ€²
AâŸ©=âŸ¨Ï•B(RA)âŸ©.
From [Î±]Ï•A(PB),[Î±]Ï•A(QB), Bob recovers âŸ¨Râ€²
BâŸ©=âŸ¨Ï•A(RB)âŸ©. Alice com-
putes EAB:=EB/âŸ¨Râ€²
AâŸ©, and Bob computes EBA:=EA/âŸ¨Râ€²
BâŸ©.The value
j(EAB) =j(EBA)is the shared key.
The problem underlying the security of MD-SIDH is stated as follows.
Problem 5. LetA=â„“a1
1Â·Â·Â·â„“at
tand let B=qb1
1Â·Â·Â·qbt
tbe two smooth coprime
integers, let fbe a small cofactor such that p=ABfâˆ’1is a prime, with Aâ‰ˆB.
LetE0/Fp2be a supersingular elliptic curve such that #E0(Fp2) = ( p+ 1)2=
(ABf )2,setE0[B] =âŸ¨P, QâŸ©.Let Aâ€²=â„“aâ€²
1
1Â·Â·Â·â„“aâ€²
t
tbeauniformlyrandomdivisorof
Aandandlet Î±beauniformlyrandomelementof Z/BZÃ—.Let Ï•:E0â†’EAbea
uniformly random isogeny of degree Aâ€². Given E0, P, Q, E A, Pâ€²= [Î±]Ï•(P), Qâ€²=
[Î±]Ï•(Q), compute Ï•.
The MD-SIDH protocol can be seen as a generalization of the M-SIDH pro-
tocol, where the degree is no longer fixed and the torsion point hidden scalars Î±
andÎ²are no longer restricted to square roots of unity. From a security point of
view, hiding the isogeny degrees might present the attacker with an additional
obstacle in running the CD-MM-R attacks, since these degrees are explicitly
used to construct attack parameters.
3.3 On the effectiveness of the countermeasures
We provide some arguments on why we believe the CD-MM-R attacks do not
extend to the countermeasures.
The attacks embed the secret isogeny Ï•of degree Binto a higher genus
isogeny Î¨of degree A=B+awhere a=Aâˆ’BandAis the order of the torsion
points. In M-SIDH, the degree of the secret isogeny is Î²2Bwhere Î²is a secret
5The integers Î±(for Alice) and Î²(for Bob) can be deleted immediately after key
generation.M-SIDH and MD-SIDH: countering SIDH attacks by masking information 11
scalar and Î²2(mod A) = 1. Embedding this isogeny into a higher genus isogeny
the same way would lead to an isogeny of degree
Î²2B+a=Î²2B+Aâˆ’B=A+B(Î²2âˆ’1) = A
1 +BÎ²2âˆ’1
A
.
This degree is unknown to the attacker, because he does not know Î². Now, since
the degree of Î¨isA(1+BÎ²2âˆ’1
A), then Î¨=Î¨2â—¦Î¨1where Î¨1has degree AandÎ¨2
has degree 1 +BÎ²2âˆ’1
A. Evaluating Î¨on the Atorsion (using the masked torsion
point information available) gives you Î¨1. The isogeny Î¨2whose unknown degree
1 +BÎ²2âˆ’1
Ais larger than Band probably non smooth remains unknown. Hence,
one cannot recover Î¨. Clearly, if Î²=Â±1then Î²2= 1andÎ¨2has degree 1 and
Î¨is fully recovered.
A similar argument applies for MD-SIDH as well. In MD-SIDH, the degree of
the secret isogeny is Î²2Bâ€²where Î²is a secret scalar and Bâ€²is a random divisor
ofB(sayB=Bâ€²B1). Embedding this isogeny into a higher genus isogeny the
same way would lead to an isogeny of degree
Î²2Bâ€²+a=Î²2Bâ€²+Aâˆ’Bâ€²B1=A+Bâ€²(Î²2âˆ’B1).
This degree is unknown to the attacker, because he does not know neither Î²nor
Bâ€²(orB1). Let d=gcd(A, Î²2âˆ’B1), then Î¨=Î¨2â—¦Î¨1where Î¨1has degree
dandÎ¨2has degreeA
d+Bâ€²Î²2âˆ’B1
d. Evaluating Î¨on the Atorsion (using the
masked torsion point information available) gives you Î¨1. The isogeny Î¨2whose
unknown degreeA
d+Bâ€²Î²2âˆ’B1
dis larger than Band probably non smooth remains
unknown. Hence, one cannot recover Î¨.
Remark 6. One could try to use a different value aâ€²instead of a=Aâˆ’Bwhen
embedding the secret isogeny into a higher genus isogeny. This would only make
thingsmorecomplicated.Infacttheunknowndegreeof Î¨isÎ²2B+aâ€²forM-SIDH
andÎ²2Bâ€²+aâ€²for MD-SIDH. As before, setting dto be the greatest common
divisor of this degree and A, then Î¨=Î¨2â—¦Î¨1where Î¨1has degree d. The isogeny
Î¨1, can be recovered, but Î¨2whose unknown degree is larger than AandB, and
is probably non smooth cannot be efficiently recovered.
4 Security analysis of the masked torsion points variant
Recall that the M-SIDH variant differs from SIDH in that parties send torsion
point images only up to a constant Î±, which is a square root of unity.
We first describe a general attack that simply consists of guessing enough
exact torsion point information to run the CD-MM-R attacks. This attack has
exponential complexity in the number of prime divisors of AandB, and it works
for any starting curve, even when the endomorphism ring is unknown.
We then describe a polynomial time attack when the initial curve is j= 1728,
and we generalize it to starting curves with (known) small degree endomor-
phisms. We argue that it appears hard to extend this attack to the case where
the endomorphism ring of the starting curve is unknown.12 T. B. Fouotsa, T. Moriya and C. Petit
We end this section with a suggestion of parameters with respect to our
analysis. In what follows we consider an isogeny of degree B, with images of
torsion points of order Arevealed up to a scalar Î±.
4.1 Guessing enough exact torsion point information
Since Bobâ€™s isogeny has degree Bâ‰ˆA, then we only need the exact images of
theâˆš
Bâ‰ˆâˆš
Atorsion points to run the CD-MM-R attacks. We are provided
with the images of the A-torsion points where A=â„“1Â·Â·Â·â„“t.
Letnâ‰¥1be the largest index such thatâˆš
Bâ‰¤â„“nÂ·Â·Â·â„“t. Set N=â„“nÂ·Â·Â·â„“t.
Then Bobâ€™s secret isogeny Ï•Bcan be recovered from its action on the N-torsion
points. From the action of [Î±]â—¦Ï•Bon the A-torsion points, one deduces the
action of [Î±]â—¦Ï•Bon the N-torsion points. The only thing preventing us from
applying the CD-MM-R attack is the unknown square root of unity Î±. Since N
hastâˆ’n+ 1prime factors, then there are at most 2tâˆ’n+1square roots of unity
modulo N. One can hence try all these square roots of unity till one gets one for
which the CD-MM-R attack is successful.
The overall complexity of this attack is ËœO(2tâˆ’n+1)using a classical computer.
Since Nâ‰ˆâˆš
AandNis made up of the largest prime factors of A, then we
must have t/2< n, which implies tâˆ’n+ 1â‰¤t/2. This attack is summarized in
Algorithm 1. We deduce Theorem 7.
Algorithm 1 Attack by using less torsion point information
Require: E0,PA,QA,EB,Pâ€²= [Î²]Ï•B(PA),Qâ€²= [Î²]Ï•B(QA)from an M-SIDH in-
stance.
Ensure: Ï•B.
1: Set N=â„“nÂ·Â·Â·â„“twhere nâ‰¥1be the largest index such thatâˆš
Bâ‰¤â„“nÂ·Â·Â·â„“t;
2: Compute P1= [A
N]Pâ€²andQ1= [A
N]Qâ€²;
3:foreach square root Î³of unity modulo Ndo
4: try to run the CD-MM-R attack to recover Ï•Bfrom E0,PA,QA,EB,[Î³âˆ’1]P1,
5: Qâ€²= [Î³âˆ’1]Q1;
6: ifThe CD-MM-R attack is successful then
7: return Ï•B.
Theorem 7. Algorithm 1 is correct and runs in time ËœO(2tâˆ’n+1)using a clas-
sical computer with tâˆ’n+ 1â‰¤t/2.
The above discussion only considers classical security. When we use a quan-
tum computer, the complexity of the attack can be improved because Grover al-
gorithm [22] allows us to find the correct Î³in Algorithm 1 in time ËœO(2(tâˆ’n+1)/2).
We deduce Theorem 8.
Theorem 8. Algorithm 1 is correct and runs in time ËœO(2(tâˆ’n+1)/2)using a
quantum computer with tâˆ’n+ 1â‰¤t/2.M-SIDH and MD-SIDH: countering SIDH attacks by masking information 13
Remark 9. From Theorem 7 and 8, the value tshould be greater than or equal
to2Î»for AES- Î»security (i.e. Î»bits of classical security and Î»/2bits of quantum
security).
4.2 Polynomial time attack when E0hasj-invariant = 1728
Castryck-Decru, Maino-Martindale and Robertâ€™s new SIDH attacks seem to re-
quire exact knowledge of torsion point images, motivating the M-SIDH variant.
On the other hand, older torsion point attacks only required these images up
to a constant [2,19], though of course they also required Amuch larger than B.
This suggests looking for an improved attack combining the best of both worlds.
LetÎ¹âˆˆEnd(E0) : (x, y)â†’(âˆ’x, iy)be a non-trivial automorphism of E0and
let
Ïˆ:=Ï•â—¦Î¹â—¦Ë†Ï•
be the "lollipop endomorphism" constructed in Petitâ€™s attack and variants (see
Section 2.2). As the images of torsion points through Ï•are provided up to a
scalar Î±where Î±2= 1 mod A, then we have that
[Î±]Ï•â—¦Î¹â—¦d[Î±]Ï•= [Î±2]â—¦Ï•â—¦Î¹â—¦bÏ•= [Î±2]â—¦Ïˆ.
Hence, from the action of [Î±]Ï•on the A-torsion, one can recover the action of
[Î±2]â—¦Ïˆon the A-torsion. Since Î±2= 1 mod A, then the images of Aâˆ’torsion
points through Ïˆare exact. Moreover as Ïˆhas degree B2â‰ˆA2and images of
torsion points of order Aare known, we can apply Robertâ€™s attack to Ïˆinstead
ofÏ•! After recovering Ïˆ, one can recover Ï†efficiently.
Remark 10. One can recover Ïˆfrom Ï•as in [31]: compute G:= ker Ï•âˆ©Eâ€²[B]
and extract the largest cyclic subgroup in G. Generically this is a large subgroup
ofkerÏ•, and the remaining part of kerÏ•is simply guessed. Note that the pow-
ersmooth case (as in M-SIDH) is considered a worst case in [31], but even in this
â€œworst case situationâ€ the cost is shown to be polynomial time in expectation
(for randomly chosen Ï•).
4.3 Generalization to other starting curves
Moregenerally,giventheendomorphismringofthestartingcurve,onecanapply
the LLL algorithm to compute a short non scalar endomorphism in it. One can
then replace the endomorphism Î¹of degree 1 in the previous attack by another
higher degree endomorphism Î¸.
AsdegÏˆ=B2degÎ¸and Robertâ€™s attack requires degÏˆâ‰¤A2, this strategy
would require to first guess the action of Ï•on a torsion Aâ€²subgroup with Aâ€²â‰¥âˆšdegÎ¸, up to a scalar. This involves guessing the images of two cyclic Aâ€²-torsion
subgroups, hence it requires O(Aâ€²2)â‰ˆdegÎ¸attempts.
The attack will be relevant for any starting curve with a small non-trivial
endomorphism. For generic curves, we will have degÎ¸â‰ˆâˆšp, so the attack will
not provide any improvement over a trivial guessing strategy.14 T. B. Fouotsa, T. Moriya and C. Petit
4.4 Generalization attempt to unknown endomorphism rings
When the endomorphism ring of the starting curve is unknown to the attacker,
one may hope to generalize the previous attack in the same way as previous tor-
sion point attacks were generalized by the Castryck-Decruâ€™s, Maino-Martindaleâ€™s
andRobertâ€™sattacks:byembeddingtheisogenyproblemintoanisogenyproblem
of higher dimension.
In particular, one could try to achieve this is by considering the genus 3
product A:=E0Ã—E0Ã—Eâ€², and an endomorphism
Ïˆ: (P1, P2, P3)â†’(P1, P2, Ï•2Î¸12Ë†Ï•1(P3))
where Ï•i:E(i)
0â†’Eâ€²fori= 1,2are two copies of the secret isogeny Ï•, and
Î¸12:E(1)
0â†’E(2)
0is a small degree isogeny from one copy of E0to the other
one. However, a closer look at this attempt reveals that Ï•2Î¸12Ë†Ï•1is just a scalar
multiplication on Eâ€², and it can therefore not help to recover Ï•. Other similar
strategies we tried led to the same issue.
5 Security analysis of the masked degree variant
In this section, we discuss the security of our second countermeasure MD-SIDH.
First, we prove that the square-free part of the degree of the secret isogeny can
be recovered efficiently; this is done in Subsection 5.1 below (together with 5.2
for a technical lemma). In Subsection 5.3 we show how to reduce any instance
of Masked-degree SIDH into an instance of Masked torsion points SIDH when
the square-free part of the secret isogeny is known. The latter implies that all
the attacks presented in Section 4 can be extended to MD-SIDH through this
reduction. Taking this into account, we suggest parameters for MD-SIDH in
Subsection 7.3.
Recall that in the MD-SIDH setting, A=â„“a1
1Â·Â·Â·â„“at
t,B=qb1
1Â·Â·Â·qbt
tand
p=ABfâˆ’1where fis a small cofactor. We are targeting Bobâ€™s secret isogeny
Ï•:E0â†’EBwhosedegree Bâ€²=qbâ€²
1
1Â·Â·Â·qbâ€²
t
tisanunknowndivisorof B,andweare
provided with E0, P, Q, E B, Pâ€²= [Î²]Ï•(P), Qâ€²= [Î²]Ï•(Q)where E0[A] =âŸ¨P, QâŸ©
andÎ²âˆˆZ/AZÃ—is unknown.
5.1 Recovering the degree up to squares
From Lemma 3, one can assume that Î²2Bâ€²modAis known. In this section we
show how to deduce a small set of candidates for the square-free part of Bâ€².
LetD(B)be the set of positive divisors of B. Given bâ€²= (bâ€²
1,Â·Â·Â·, bâ€²
t)âˆˆZt,
we write B(bâ€²) =qbâ€²
1
1Â·Â·Â·qbâ€²
t
t, and similarly if Bâ€²=B(bâ€²), we write bâ€²=b(Bâ€²).
These maps restrict to a one-to-one correspondence betweenQt
i=1Z/(bi+ 1)Z
andD(B). For simplicity, we suppose that the â„“is and the qis are odd primes6.
6The case where â„“i= 2in general does not fit our definition of Ï‡since there are more
than two square roots of 1modulo 2rforr >2. Nevertheless, if the power of 2diving
AorBis at least 4, then the security of the scheme is not affected.M-SIDH and MD-SIDH: countering SIDH attacks by masking information 15
LetÏ‡â„“ai
ibethenaturalsurjection Ï‡â„“ai
i: (Z/â„“ai
iZ)Ã—â†’(Z/â„“ai
iZ)Ã—/((Z/â„“ai
iZ)Ã—)2âˆ¼=
{âˆ’1,1}. Consider the map
Î¦:Ztâˆ’â†’ {âˆ’ 1,1}t
bâ€²7âˆ’â†’
Ï‡â„“a1
1(B(bâ€²)), . . . , Ï‡â„“at
t(B(bâ€²)),
where we regard B(bâ€²)as an element in (Z/â„“bi
iZ)Ã—. Clearly, Î¦is a group mor-
phism and (2Z)tâŠ‚kerÎ¦. This implies that the following group homomorphism
is well-defined:
Î¦: (Z/2Z)tâˆ’â†’ Im(Î¦)âŠ‚ {âˆ’ 1,1}t
bâ€²7âˆ’â†’ Î¦(bâ€²).
Since the cardinality of the domain of the group morphism Î¦is2t, then
# ker Î¦= 2tÎ¦for some 0â‰¤tÎ¦â‰¤t. This implies that when given Î¦(b(Bâ€²)),
we have #Î¦âˆ’1(Î¦(b(Bâ€²))) = 2tÎ¦. In other words, giving Î¦(b(Bâ€²))is the same as
giving tâˆ’tÎ¦bits of information about b(Bâ€²) mod 2. Furthermore, when tÎ¦= 0,
that is when Î¦is an isomorphism, then Î¦(bâ€²)uniquely determines b(Bâ€²) mod 2.
Note that for any representative bâ€²in the class b(Bâ€²) + 2Zt, the integers B(bâ€²)
andBâ€²have the same square-free factor.
Lemma 11. Consider the notations above. Let Bâ€²
1be the square-free part of Bâ€².
Then given E0, P, Q, E B, Pâ€²andQâ€², there exists a probabilistic polynomial
time algorithm that reduces the search space for Bâ€²
1to a set of order 2tÎ¦where
2tÎ¦= # ker Î¦.
Proof.From P, Q, E B, Pâ€²,andQâ€², use Lemma 3 to recover d=Î²2Bâ€²modA.
Compute
Î¦(b(d)) =
Ï‡â„“a1
1(Î²2Bâ€²),Â·Â·Â·, Ï‡â„“at
t(Î²2Bâ€²)
=
Ï‡â„“a1
1(Bâ€²),Â·Â·Â·, Ï‡â„“at
t(Bâ€²)
=Î¦(b(Bâ€²)).
Compute kerÎ¦and a preimage b0ofÎ¦(b(d))with respect to Î¦. Return the set
{B(b)|bâˆˆb0+ ker Î¦}of square-free integers.
Clearly, all the computational steps described above run in polynomial time.
The correctness follows from the properties of the morphism Î¦andÎ¦discussed
before the lemma. âŠ“ âŠ”
In the next subsection, we show that tÎ¦is expected to be small for most
parameters, and the squarefree part of Bâ€²can therefore be guessed with a high
probability.
5.2 On the value of tÎ¦
In this section we estimate tÎ¦. We start by observing the following.
Lemma 12. Lettbe an integer and let Mbe a random tÃ—tmatrix over F2.
Then as ttends towards âˆž, we have have tâˆ’2â‰¤rank (M)with probability
0.9947145498 .16 T. B. Fouotsa, T. Moriya and C. Petit
Proof.Letpt(k)be the probability that a uniformly random tÃ—t-matrix over
F2has rank tâˆ’k. Then, from [25, p.33] and [11, Theorem 1], it holds that
Ï€(k) := lim
tâ†’âˆžpt(k) =ï£±
ï£´ï£´ï£´ï£²
ï£´ï£´ï£´ï£³âˆžY
i=1
1âˆ’1
2i
, (k= 0)
Qâˆž
i=k+1(1âˆ’(1/2i))
Qk
i=1(1âˆ’(1/2i))1
2k2,(kâ‰¥1).
From[11,Table1],wehave Ï€(0)isabout 0.2887880951 ,Ï€(1)isabout 0.5775761902 ,
Ï€(2)is about 0.1283502645 , and Ï€(k)â€™s for kâ‰¥3are less than 0.0052387863 .
Therefore,
Pr(kâ‰¤2) = Ï€(0) + Ï€(1) + Ï€(2)â‰ˆ0.9947145498 .
âŠ“ âŠ”
Considerthematrix Mâˆ—ofthemorphism (1âˆ’Â¯Î¦)/2(operationsaredonecom-
ponent wise). Lemma 12 applies to random matrices and tneeds to be somehow
large. In practice, tis relatively small, tâ‰ˆO(Î»)where Î»is the security param-
eter, and, AandBare system parameters, which could in theory be chosen to
maximize tÏ•. However, for the sake of the schemeâ€™s practicality, the integers A
andBneed to be as small as possible. Also, in order to not weaken one of the
participants, AandBneed to satisfy Aâ‰ˆB. With these constraints, we do not
expect to have 2< tÎ¦. Intuitively, if 2< tÎ¦, then there are tÎ¦square-free inte-
gers that are all quadratic residues modulo all the tprime power divisors of A.
Given a random square-free integer N,Nis a quadratic residue modulo a given
prime power with probability1
2, hence it is a quadratic residue modulo t"in-
dependent" distinct prime powers with probability roughly1
2t. Since tâ‰ˆO(Î»),
then1
2tis negligible. Hence the probability that there exists many such integers
Nrapidly decreases below1
2Î». For example, given t, letâ„“1, q1, â„“2, q2, . . . , â„“ t, qtbe
the smallest 2todd primes. For t= 64,96,128,192,286,420,426,566,637,856,
we obtained tÎ¦= 1,0,1,2,0,0,1,0,1,0respectively.
In conclusion, we believe that it is computationally hard in practice to come
up with integers AandBsuch that 2â‰ªtÎ¦. Also, if ever such integers were
computed, AandBwould be too large, which would lead to an impractical
scheme.
5.3 Reduction to the M-SIDH variant
We now show how to reduce a MD-SIDH instance to an M-SIDH instance.
RecallthatintheMD-SIDHcase(Problem5),wearegiven E0, P, Q, E B, Pâ€²=
[Î²]Ï•(P), Qâ€²= [Î²]Ï•(Q), where E0[A] =âŸ¨P, QâŸ©,Ï•is a random isogeny of degree
Bâ€²with Bâ€²being a random divisor of B, and Î²is a random integer coprime to
A; and we are asked to recover Ï•.
Following Subsections 5.1 and 5.2, we assume that the square-free part of the
degree of the secret isogeny is known. Let Bâ€²
1be the square-free part of Bâ€². Let
B0be the largest divisor of Bwhich is equal to Bâ€²up to squares, and let Î²0beM-SIDH and MD-SIDH: countering SIDH attacks by masking information 17
the divisor of Bsuch that B0=Î²2
0Bâ€². Since Bis a smooth integer and we know
Bâ€²
1, we can compute B0.
LetÏ•0= [Î²0]â—¦Ï•. We then know degÏ•0=Î²2
0degÏ•=Î²2
0Bâ€²=B0â‰¤B.
Moreover, we have
Pâ€²= [Î²]Ï•(P) = [( Î²Î²âˆ’1
0)Â·Î²0]Ï•(P) = [Î²Î²âˆ’1
0]Ï•0(P)
Qâ€²= [Î²]Ï•(Q) = [( Î²Î²âˆ’1
0)Â·Î²0]Ï•(Q) = [Î²Î²âˆ’1
0]Ï•0(Q)
From Lemma 3, we can recover Î²2Bâ€²modA, and compute
Î²2
1=Î²2
0Bâ€²Â·(Î²2Bâ€²)âˆ’1modA= (Î²0Â·Î²âˆ’1)2modA.
We sample a random square root Î²â€²
1ofÎ²2
1mod A, namely Î²â€²
1=ÂµÎ²1where Âµis
some square root of unity modulo A. We compute

[Î²â€²
1]Pâ€²= [ÂµÂ·Î²1]Pâ€²= [ÂµÂ·Î²0Â·Î²âˆ’1Â·Î²]Ï•(P) = [ÂµÂ·Î²0]Ï•(P) = [Âµ]Ï•0(P)
[Î²â€²
1]Qâ€²= [ÂµÂ·Î²1]Pâ€²= [ÂµÂ·Î²0Â·Î²âˆ’1Â·Î²]Ï•(Q) = [ÂµÂ·Î²0]Ï•(Q) = [Âµ]Ï•0(Q)
From here, one solves for Ï•0where E0,P,Q,EB,[Âµ]Ï•0(P),[Âµ]Ï•0(Q)and
degÏ•0=Î²2
0Bâ€²are provided. This is in fact an M-SIDH instance, with the only
difference that the secret isogeny is not cyclic. This is not a problem since the
highergenustorsionpointsattackhasnorestrictiononthetypeofisogeny(cyclic
or not) in play.
5.4 Reduction impact: porting M-SIDH attacks to MD-SIDH
In this section we revisit the attacks of Section 4 and check that they still apply
when the secret isogeny is not cyclic. Recall that the isogeny to recover here is
Ï•0= [Î²0]â—¦Ï•where Î²0is an unknown integer such that the degree B0=Î²2
0Bâ€²
ofÏ•0divides B. We are provided with the B0= deg Ï•0and the action of Ï•0on
theAtorsion group up to a scalar (a root of unity modulo A).
We start with Robertâ€™s attack (see Section 2.2), and observe that neither
the definition of the isogeny Î¨nor the way Ï•is deduced from this isogeny rely
onÏ•being a cyclic isogeny. The attack of Section 4.1 simply guesses the exact
torsion point images on the minimal amount of torsion point information needed
for Robertâ€™s attack. As before, allowing for non cyclic isogenies does not affect
Robertâ€™s attack.
Regarding the attack of Section 4.2, one first applies Robertâ€™s attack on
Ïˆ=Ï•0â—¦Î¹â—¦Ë†Ï•0= [Î²2
0]â—¦Ï•â—¦Î¹â—¦Ï•, then one deduces the isogeny Ï•0using [31, Â§4.3].
The first part is again an application of Robertâ€™s attack to a non cyclic isogeny.
The second part requires some clarification.
When Ï•0=Ï•is cyclic ( Î²0= 1), in [31, Â§4.3], the attacker computes G:=
kerÏˆâˆ©EB[B0], which clearly contains kerÏ•, and is in general isomorphic to
Z/NZÃ—Z/Nâ€²Zfor some Nâ€²|N|B0such that NNâ€²=B0. When Nâ€²= 1we have
G= ker Ï•. For a cyclic isogeny Ï•, we have Nâ€²>1exactly when Î¹leaves either
kerÏ•âˆ©E0[Nâ€²]orkerË†Ï•âˆ©EB[Nâ€²]invariant: this leaves at most 2rcandidates for
kerÏ•, where ris the number of prime factors in Nâ€². But, since Ï•is uniformly18 T. B. Fouotsa, T. Moriya and C. Petit
random (because it is the secret isogeny), then Nâ€²is relatively small and hence
has very few prime factors.
Let us return to the case where Ï•0= [Î²0]â—¦Ï•with Ï•being cyclic and Î²0>1
is unknown, and let us assume that Ïˆ=Ï•0â—¦Î¹â—¦Ë†Ï•0= [Î²2
0]â—¦Ï•â—¦Î¹â—¦Ï•has been
recovered. After evaluating Ïˆon the B0torsion, we will get a group isomorphic
toZ/CZÃ—Z/Câ€²Zwhere Câ€²|C|B0. Since Ïˆis divisible by Î²2
0, the Î²2
0-torsion is
killed by Ïˆand the group Z/CZÃ—Z/Câ€²Zis the group one would have got if one
was evaluating Ï•â—¦Î¹â—¦Ï•on the Bâ€²=B0/Î²2
0torsion. Hence CCâ€²=Bâ€²= deg Ï•as
discussed in the previous paragraph and Î²0=p
B0/Bâ€². One then recovers Ï•as
in the previous paragraph.
6 Adaptive attacks
In this section, we show that M-SIDH and MD-SIDH, as SIDH, are vulnerable
to adaptive attacks. We also discuss the use of B-SIDH primes in M-SIDH and
future work. We first discuss the Fouotsa-Petit attack, then the GPST attack.
6.1 Fouotsa-Petit adaptive attack.
Fouotsa-Petit [19] adaptive attack consists in actively transforming a balanced
SIDH instance ( Aâ‰ˆB) into an imbalanced one ( B < Aâˆ—=NAwhere Nâ‰ˆp),
thenrunningPetitâ€™storsionpointattacks[31,32]ontheimbalancedSIDH(where
the secret isogeny has degree Band the torsion points have order Aâˆ—=NA) to
recover the secret isogeny.
In [19, Section 3.2], the authors show that Petitâ€™s torsion point attacks can
be run even when the torsion point images are scaled with an unknown scalar.
Petitâ€™s attacks also apply to non cyclic isogenies. In fact, to recover an isogeny
Ï•:Eâˆ’â†’Eâ€²from its action on large enough torsion points, Petitâ€™s attack (see
Section 2.2) uses the torsion point information and a suitable endomorphism Î¸of
Eto compute the endomorphism Ïˆ=Ï•â—¦Î¸â—¦Ï•ofEâ€²; then the techniques of [31,
Â§4.3] (also see Section 5.4) are used to recover Ï•. As before, Ï•not being cyclic
does not impact the first step where one recovers Ïˆ. There are some subtleties
when trying to recover Ï•from Ïˆwhen Ï•is non cyclic, but they were already
covered in Section 5.4. However, Petitâ€™s attacks do require knowledge of the
degree of the secret isogeny.
The generalization of the Fouotsa-Petit [19] adaptive attack to M-SIDH is
therefore straightforward. For MD-SIDH, one can use the techniques from Sec-
tion 5 to reduce the MD-SIDH instance to an M-SIDH instance, and then run
the Fouotsa-Petit attack on the M-SIDH instance.
6.2 GPST adaptive attack.
Recall that in the GPST attack on SIDH, Bob (the honest party) has a static
secretkey/publickeypair( b,(EB,Ï•B(PA), Ï•B(QA)).Alice(thedishonestparty)
maliciouslygeneratespublickeys (EA, R, S )withmodifiedtorsionpointsimages,M-SIDH and MD-SIDH: countering SIDH attacks by masking information 19
and repeatedly runs the key exchange with Alice using these malicious public
keys. The attack assumes that Alice is provided with an oracle O(EA, R, S, Eâ€²)
that outputs 1ifEâ€²is the shared secret computed by the honest Bob when using
(EA, R, S )asAliceâ€™spublickey,and 0otherwise.ThentheGPSTadaptiveattack
recovers the secret bwith only logbqueries to the oracle O. The attack provides
the points (Ri, Si)to be used at each query. We refer to [20] for details about
the GPST adaptive attack.
One thing to notice here is that
O(EA, R, S, Eâ€²) = 1â‡â‡’ EA/âŸ¨R+ [b]SâŸ©=EA/âŸ¨Ï•A(PB) + [b]Ï•A(QB)âŸ©
â‡â‡’ âŸ¨ R+ [b]SâŸ©=âŸ¨Ï•A(PB) + [b]Ï•A(QB)âŸ©
where the second equivalence holds except with neglible probability. Hence, as-
suming EAis fixed, we can see Oas an oracle that when given R, S, outputs 1if
âŸ¨R+ [b]SâŸ©=âŸ¨Ï•A(PB) + [b]Ï•A(QB)âŸ©, and 0if not. Note that the malicious points
RandSare obtained by doing a linear combination of Ï•A(PB)andÏ•A(QB),
sayR= [e1]Ï•A(PB) + [e2]Ï•A(QB)andS= [f1]Ï•A(PB) + [f2]Ï•A(QB).
WhenitcomestoM-SIDH,theimagepointsarescaledwithasecretinvertible
scalar Î². But, as the scalar is invertible and everything is linear, the attack can
proceed in the same way.
For MD-SIDH, the degree Bâ€²of Bobâ€™s secret isogeny is an unknown divisor
ofB. The torsion points RandSare first scaled by the secret integer B1=B
Bâ€²
beforebeingusedbyBob;thatisBobcomputestheisogeny EAâ†’EA/âŸ¨[B1](R+
[b]S)âŸ©. Hence our new oracle here acts as follows: when given RandS, it outputs
1ifâŸ¨[B1](R+ [b]S)âŸ©=âŸ¨[B1](Ï•A(PB) + [b]Ï•A(QB))âŸ©, and 0otherwise.
Here, blindly applying the GPST adaptive attack would not work, as the
attacker first needs to recover the degree Bâ€²of the secret isogeny or equivalently
the integer B1=B
Bâ€². Moreover unlike for the Fouotsa-Petit attack, one cannot
simply apply our reduction from Section 4 to recover the degree and then apply
GPST attack, because the GPST attack assumes a cyclic secret isogeny.
To recover the integer B1, we instead use the above oracle. Let qebe a prime
power divisor of B. We would like to recover the largest integer eâ€²â‰¤esuch that
qeâ€²divides Bâ€². We repeatedly query the oracle with the points
Ri=Ï•A(PB) +B
qi
Ï•A(QB), S i=Ï•A(QB),1â‰¤iâ‰¤e.
We have the following lemma.
Lemma 13. With the notations as above, we have
O
Ï•B(PA) +B
qi
Ï•A(QB), Ï•A(QB)
= 1
if and only if qidivides B1.
Proof.SetRi=Ï•A(PB) +h
B
qii
Ï•A(QB)andSi=Ï•A(QB). We have
âŸ¨[B1](Ri+ [b]Si)âŸ©=âŸ¨[B1](Ï•A(PB) +h
B
qii
Ï•A(QB) + [b]Ï•A(QB))âŸ©
=âŸ¨[B1] (Ï•A(PB) + [b]Ï•A(QB)) + [B
qi][B1]Ï•A(QB)âŸ©.20 T. B. Fouotsa, T. Moriya and C. Petit
Clearly, the points [B1](Ï•A(PB) + [b]Ï•A(QB))and[B1]Ï•A(QB)have order Bâ€²
and are linearly independent. Hence
âŸ¨[B1] (Ï•A(PB) + [b]Ï•A(QB))âŸ©=âŸ¨[B1] (Ï•A(PB) + [b]Ï•A(QB))+B
qi
[B1]Ï•A(QB)âŸ©
if and only ifB
qi= 0 mod Bâ€², that is if and only if qidivides B1. The Lemma
then follows from the definition of the oracle O. âŠ“ âŠ”
Using Lemma 13, one recovers each prime power divisor qeâ€²
i
iofB1=B
Bâ€²with at
most eiqueries, where B=qe1
1Â·Â·Â·qet
t,i= 1, . . . , t. The total maximum number
ofqueriestorecoverthesecretdegree Bâ€²isPt
i=1ei.Oncethedegreeisrecovered,
one then runs the usual GPST attack.
7 Parameter selection and efficiency
In this section, we discuss the choice of the starting curve E0, and we use the
analysis from the previous sections to infer parameter selections for both M-
SIDH and MD-SIDH. We conclude that the M-SIDH variant is always more
secure than the MD-SIDH variant at comparable parameter sizes, and discuss
its efficiency.
7.1 Choosing the starting curve E0
From the attack in Section 4.2 and its generalization to MD-SIDH in Section 5.4,
an elliptic curve with a short-degree endomorphism (e.g., the curve of j-invariant
1728) should not be used for a starting curve in either scheme. Therefore the
setup algorithm needs to generate E0as a curve with no short-degree endomor-
phism. There are three possibilities here:
1. the endomorphism ring of the curve is public,
2. the endomorphism ring of the curve is not public, but known by one party
(either Alice or Bob);
3. the endomorphism ring is unknown to everyone.
The advantage of the first possibility is that since the endomorphism ring of
E0is public, everyone can verify that E0does not have small endomorphisms
by determining the norm of the shortest element End(E0)(this is a dimension
4lattice, so computing the shortest element is easy). One can use BrÃ¶kerâ€™s al-
gorithm [6] to generate E0, or obtain E0by performing a random walk from
a supersingular curve computed using BrÃ¶kerâ€™s algorithm. The first option is
not secure since the supersingular curves generated using BrÃ¶kerâ€™s algorithm
have small endomorphisms. In the second option, the party that generates the
curve could backdoor it. In fact, they could generate a weak curve in the sense
of [32]. Weak curves are curves for which Petitâ€™s torsion point attack has the
best efficiency for a given set of parameters.M-SIDH and MD-SIDH: countering SIDH attacks by masking information 21
In the second scenario, one of the participants generates the curve and does
not reveal its endomorphism ring. This party could hence potentially cheat and
use a curve with small endomorphisms or a weak curve, then use it to attack the
other party. This is not acceptable for a key exchange protocol. Nevertheless, in
thesettingofaSIKE-typekeyencapsulationmechanismorpublickeyencryption
scheme, we can let the key generation algorithm generate the starting curve and
publish it together with their public key: indeed using a weak curve here would
only make their own secret key weaker.
Regarding the third scenario, one should note that generating a supersingu-
lar curve with unknown endomorphism ring is a hard problem [4,28]. Instead,
one can rely on a trusted third party (possibly simulated by a multiparty pro-
tocol [1]) to generate a truly random supersingular E0curve by performing a
long random walk for a known supersingular curve, and forgets (deletes) the
walk they used. Then the obtained curve could be used as starting curve for the
schemes suggested in this scheme.
In conclusion, restricting E0to curves which do not have small endomor-
phisms is sufficient when instantiating M-SIDH and MD-SIDH. Nevertheless,
one would need to trust the party generating the curve since they could backdoor
it (we could not find a method to generate curves with no small endomorphisms
in the literature). Since we would need to trust them anyway, it is better to just
ask this party to generate a curve with unknown endomorphism ring. This can
also be done using the MPC techniques described in [1].
7.2 Parameter selection for M-SIDH
Recall that the M-SIDH primes are of the form p=ABfâˆ’1where A=â„“1Â·Â·Â·â„“t
andB=q1Â·Â·Â·qtare coprime integedo â„“i, qiare distinct small primes, Aâ‰ˆBâ‰ˆâˆšpandfis a small cofactor. Let Î»be the security parameter. From subsection
4.1, we need tâˆ’n+ 1â‰¥Î»for classical security and tâˆ’n+ 1â‰¥2Î»for quantum
security, where nis the largest integer satisfyingâˆš
Bâ‰¤â„“nÂ·Â·Â·â„“t, where Î»is a
security parameter.
We now explain how to generate the public parameters of M-SIDH for AES- Î»
security (i.e., classical Î»bits security and quantum Î»/2bits security). Given Î»,
we sample the 2tsmallest primes for tâ‰¥2Î», we partition them into two sets of
equal size, we use the first set to get Aand we use the second to get B, such
that Aâ‰ˆB. We then check the value tâˆ’n+ 1described in subsection 4.1. If
Î» < tâˆ’n+ 1, we restart with a larger t. IfÎ»â‰¥tâˆ’n+ 1, find a cofactor fsuch
thatp=ABfâˆ’1is prime.
For AES-128 (NIST level 1), AES-192 (NIST level 3) and AES-256 (NIST
level 5) security levels, Table 1 presents the key sizes, including secret key, public
key and compressed public key. The suggested primes for M-SIDH are
p128= 22Â·â„“1Â·Â·Â·â„“571Â·10âˆ’1,
p192= 22Â·â„“1Â·Â·Â·â„“851Â·207âˆ’122 T. B. Fouotsa, T. Moriya and C. Petit
and
p256= 22Â·â„“1Â·Â·Â·â„“1131Â·13âˆ’1
respectively; where â„“iis the ith odd prime. Alice uses A= 22Â·â„“2Â·â„“4Â·Â·Â·â„“tâˆ’2and
Bob uses B=â„“1Â·â„“3Â·Â·Â·â„“tâˆ’1.
AESNIST p(in bits) secret key public key compressed pk
128level 1 5911 â‰ˆ369bytes 4434bytes â‰ˆ2585bytes
192level 3 9382 â‰ˆ586bytes 7037bytes â‰ˆ4103bytes
256level 5 13000 â‰ˆ812bytes 9750bytes â‰ˆ5687bytes
Table 1. Suggested parameters for 128, 192 and 256 bits of security.
7.3 Parameter selection for MD-SIDH
We showed in previous sections that MD-SIDH can be broken by the same
attacks as M-SIDH. Therefore, tâˆ’n+ 1must be greater than or equal to Î»
for AES- Î»security, where nis the largest integer such that there is a subset
SâŠ‚ {1, . . . , t}satisfyingâˆš
Bâ‰¤Q
iâˆˆSâ„“ai
iandn=t+1âˆ’#S. Moreover, to mask
the degree of the secret isogeny, the size of the space of degrees needs to be 2Î»+t
since the Weil pairing will reduce it by a factor 2t.
Given Î», we sample the 2tsmallest primes for tâ‰¥Î», we set a1=Â·Â·Â·=aÎ»=
b1=Â·Â·Â·=bÎ»= 3and the other exponents are 1, and we partition them into two
sets of equal size. We use the first set to get Aand the second to get B, such that
Aâ‰ˆB. We check the value tâˆ’n+ 1described above. If Î» < tâˆ’n+ 1, we restart
with a larger t. IfÎ»â‰¥tâˆ’n+ 1, we find a cofactor fsuch that p=ABfâˆ’1is
prime.
For AES-128 (NIST level 1), AES-192 (NIST level 3) and AES-256 (NIST
level 5) security levels, Table 2 presents the key sizes: secret key, public key and
compressed public key. The suggested primes for M-SIDH are
p128= 23Â·â„“3
1Â·Â·Â·â„“3
255â„“256Â·Â·Â·â„“839Â·537âˆ’1,
p192= 23Â·â„“3
1Â·Â·Â·â„“3
383â„“384Â·Â·Â·â„“1273Â·131âˆ’1
and
p256= 23Â·â„“3
1Â·Â·Â·â„“3
511â„“512Â·Â·Â·â„“1711Â·1485âˆ’1
respectively;where â„“iisthe ithoddprime.Aliceuses A= 23Â·â„“3
2Â·Â·Â·â„“3
Î»âˆ’2â„“Î»Â·Â·Â·â„“tâˆ’2
and Bob uses B=â„“3
1Â·Â·Â·â„“3
Î»âˆ’1â„“Î»+1Â·Â·Â·â„“tâˆ’1.M-SIDH and MD-SIDH: countering SIDH attacks by masking information 23
AESNIST p(in bits) secret key public key compressed pk
128level 1 13810 â‰ˆ863bytes 10358bytes â‰ˆ6040bytes
192level 3 22291 â‰ˆ1393bytes 16719bytes â‰ˆ9751bytes
256level 5 31226 â‰ˆ1951bytes 23420bytes â‰ˆ13660bytes
Table 2. Suggested parameters for 128, 192 and 256 bits of security.
7.4 Preliminary efficiency analysis
From the two subsections above, it is clear that the M-SIDH variant is more
secure than the MD-SIDH variant for comparable parameter sizes.
Compressed public key sizes for M-SIDH have 2585, 4103 and 5687 bytes at
security levels 128, 192 and 256. This is roughly 6.8, 7.3 and 7.8 bigger than
previously suggested SIKE keys for the same security levels. Asymptotically,
Keys scale quasi-linearly in the security parameter, whereas SIKE keys scaled
linearly.
Computations required in M-SIDH are similar to those required in SIDH,
with additional (comparably negligible) scalar multiplications to mask torsion
points, individual isogeny steps of degrees O(Î»logÎ»)instead of 2 and 3, and
larger parameter sizes. In SIDH, we have O(Î»logÎ»)isogeny steps with optimal
strategies [16], with each step costing O(1)field operations. Field sizes are O(Î»)
so each field operation costs O(Î»logÎ»)bit operations asymptotically, neglecting
log logfactors. This leads to a total asymptotic bit complexity of O(Î»2log2Î»)
bit operations. In M-SIDH, we use O(Î»)primes each of size O(logÎ»), so the total
prime size is O(Î»logÎ»). There are still O(Î»logÎ»)steps involved with optimal
strategies. Eachsteprequires O(âˆšÎ»logÎ»)fieldoperationsusingsquarerootVÃ©lu
formulae. Field operations cost O(Î»log2Î»)bit operations asymptotically, again
neglecting log logfactors. This gives a total of O(Î»2.5log7/2Î»)bit operations.
Concrete efficiency should be determined in future work, but a slowdown com-
pared to SIDH should be expected, with a factor in the order of O(âˆš
Î»log3/2Î»).
Most efficiency and implementation tricks developed for SIDH should also be
available for M-SIDH, and potentially more, but we argue in Appendix B that
the B-SIDH approach will not be applicable.
8 Conclusion and perspectives
WeintroducedtwovariantsoftheSIDHprotocolsaimedatdefeatingtheCastryck-
Decru-Maino-Martindale-Robert recent attacks. The two variants respectively
hide the secret isogeny degree and the torsion point information to the attacker
(more precisely they only reveal an integer multiple of the degree, and they
reveal torsion point images only up to a scalar).
Our thorough security analysis of both variants suggests that the M-SIDH
variant offers the best security-efficiency tradeoff. Public key sizes are 4434, 7037
and 9750 bytes respectively for AES-128 (NIST level 1), AES-192 (NIST level 3)
andAES-256(NISTlevel5)security,andefficiencyisexpectedtoasymptotically
be a factor in the order of O(âˆš
Î»log3/2Î»)slower compared to SIDH.24 T. B. Fouotsa, T. Moriya and C. Petit
Our work suggests that it may be possible to repair the SIDH protocol,
although at a non negligible efficiency cost, and it similarly offers a way forward
to the numerous cryptographic schemes based on SIDH that were developed in
recent years. Further work should aim at developing additional countermeasures
and at improving the efficiency and security analysis of our schemes.
Acknowledgements. We thank Castryck and Onuki for their valuable feed-
back on a preliminary version of the results in this paper, as well as those of the
participants at ANTS 2022 that also gave us some feedback. The first author
thanks Andrea Basso and Luca De Feo for several discussions regarding this
work. We thank anonymous reviewers for their valuable feedback. This research
was in part conducted under a contract of â€œResearch and development on new
generation cryptography for secure wireless communication servicesâ€ among â€œRe-
search and Development for Expansion of Radio Wave Resources (JPJ000254)â€,
which was supported by the Ministry of Internal Affairs and Communications,
Japan. Christophe Petitâ€™s work is in part supported by an EPSRC fellowship
grant (EP/V011324/1).
References
1. Basso, A., Codogni, G., Connolly, D., De Feo, L., Fouotsa, T.B., Lido, G.M.,
Morrison, T., Panny, L., Patranabis, S., Wesolowski, B.: Supersingular curves
you can trust. Cryptology ePrint Archive, Report 2022/1469 (2022), https:
//eprint.iacr.org/2022/1469
2. Basso, A., Kutas, P., Merz, S.P., Petit, C., Sanso, A.: Cryptanalysis of an oblivious
PRF from supersingular isogenies. In: Tibouchi, M., Wang, H. (eds.) Advances in
Cryptology â€“ ASIACRYPT 2021, Part I. Lecture Notes in Computer Science, vol.
13090, pp. 160â€“184. Springer, Heidelberg, Germany, Singapore (Dec 6â€“10, 2021).
https://doi.org/10.1007/978-3-030-92062-3_6
3. Beullens, W., Kleinjung, T., Vercauteren, F.: CSI-FiSh: Efficient isogeny based
signatures through class group computations. In: Galbraith, S.D., Moriai, S. (eds.)
Advances in Cryptology â€“ ASIACRYPT 2019, Part I. Lecture Notes in Computer
Science, vol. 11921, pp. 227â€“247. Springer, Heidelberg, Germany, Kobe, Japan
(Dec 8â€“12, 2019). https://doi.org/10.1007/978-3-030-34578-5_9
4. Booher, J., Bowden, R., Doliskani, J., Fouotsa, T.B., Galbraith, S.D., Kun-
zweiler, S., Merz, S.P., Petit, C., Smith, B., Stange, K.E., Ti, Y.B., Vincent,
C., Voloch, J.F., WeitkÃ¤mper, C., Zobernig, L.: Failing to hash into supersingu-
lar isogeny graphs. Cryptology ePrint Archive, Report 2022/518 (2022), https:
//eprint.iacr.org/2022/518
5. Bottinelli, P., de Quehen, V., Leonardi, C., Mosunov, A., Pawlega, F., Sheth, M.:
The dark SIDH of isogenies. Cryptology ePrint Archive, Report 2019/1333 (2019),
https://eprint.iacr.org/2019/1333
6. BrÃ¶ker, R.: Constructing supersingular elliptic curves. Journal of Combinatorics
and Number Theory 1(3), 269â€“273 (2009)
7. Castryck, W., Decru, T.: An efficient key recovery attack on SIDH (preliminary
version). Cryptology ePrint Archive, Report 2022/975 (2022), https://eprint.
iacr.org/2022/975M-SIDH and MD-SIDH: countering SIDH attacks by masking information 25
8. Castryck, W., Lange, T., Martindale, C., Panny, L., Renes, J.: CSIDH: An efficient
post-quantum commutative group action. In: Peyrin, T., Galbraith, S. (eds.) Ad-
vances in Cryptology â€“ ASIACRYPT 2018, Part III. Lecture Notes in Computer
Science,vol.11274,pp.395â€“427.Springer,Heidelberg,Germany,Brisbane,Queens-
land, Australia (Dec 2â€“6, 2018). https://doi.org/10.1007/978-3-030-03332-3_
15
9. Charles, D.X., Lauter, K.E., Goren, E.Z.: Cryptographic hash functions from ex-
pander graphs. Journal of Cryptology 22(1), 93â€“113 (Jan 2009). https://doi.
org/10.1007/s00145-007-9002-x
10. ColÃ², L., Kohel, D.: Orienting supersingular isogeny graphs. Cryptology ePrint
Archive, Report 2020/985 (2020), https://eprint.iacr.org/2020/985
11. Cooper, C.: On the rank of random matrices. Random Structures & Al-
gorithms 16(2), 209â€“232 (2000). https://doi.org/https://doi.org/10.1002/
(SICI)1098-2418(200003)16:2<209::AID-RSA6>3.0.CO;2-1
12. Costello, C.: B-SIDH: Supersingular isogeny Diffie-Hellman using twisted torsion.
In: Moriai, S., Wang, H. (eds.) Advances in Cryptology â€“ ASIACRYPT 2020,
Part II. Lecture Notes in Computer Science, vol. 12492, pp. 440â€“463. Springer,
Heidelberg, Germany, Daejeon, South Korea (Dec 7â€“11, 2020). https://doi.org/
10.1007/978-3-030-64834-3_15
13. Costello, C., Meyer, M., Naehrig, M.: Sieving for twin smooth integers with solu-
tions to the prouhet-tarry-escott problem. In: Canteaut, A., Standaert, F.X. (eds.)
Advances in Cryptology â€“ EUROCRYPT 2021, Part I. Lecture Notes in Computer
Science, vol. 12696, pp. 272â€“301. Springer, Heidelberg, Germany, Zagreb, Croatia
(Oct 17â€“21, 2021). https://doi.org/10.1007/978-3-030-77870-5_10
14. Couveignes, J.M.: Hard homogeneous spaces. Cryptology ePrint Archive, Report
2006/291 (2006), https://eprint.iacr.org/2006/291
15. De Feo, L., Galbraith, S.D.: SeaSign: Compact isogeny signatures from class
group actions. In: Ishai, Y., Rijmen, V. (eds.) Advances in Cryptology â€“ EU-
ROCRYPT 2019, Part III. Lecture Notes in Computer Science, vol. 11478, pp.
759â€“789. Springer, Heidelberg, Germany, Darmstadt, Germany (May 19â€“23, 2019).
https://doi.org/10.1007/978-3-030-17659-4_26
16. DeFeo,L.,Jao,D.,PlÃ»t,J.:Towardsquantum-resistantcryptosystemsfromsuper-
singular elliptic curve isogenies. Journal of Mathematical Cryptology 8(3), 209â€“247
(Jun 2014). https://doi.org/doi:10.1515/jmc-2012-0015
17. De Feo, L., Kohel, D., Leroux, A., Petit, C., Wesolowski, B.: SQISign: Compact
post-quantum signatures from quaternions and isogenies. In: Moriai, S., Wang,
H. (eds.) Advances in Cryptology â€“ ASIACRYPT 2020, Part I. Lecture Notes in
Computer Science, vol. 12491, pp. 64â€“93. Springer, Heidelberg, Germany, Daejeon,
South Korea (Dec 7â€“11, 2020). https://doi.org/10.1007/978-3-030-64837-4_3
18. Fouotsa,T.B.:SIDHwithmaskedtorsionpointimages.CryptologyePrintArchive,
Report 2022/1054 (2022), https://eprint.iacr.org/2022/1054
19. Fouotsa, T.B., Petit, C.: A new adaptive attack on SIDH. In: Galbraith, S.D.
(ed.) Topics in Cryptology â€“ CT-RSA 2022. Lecture Notes in Computer Science,
vol. 13161, pp. 322â€“344. Springer, Heidelberg, Germany, Virtual Event (Mar 1â€“2,
2022). https://doi.org/10.1007/978-3-030-95312-6_14
20. Galbraith, S.D., Petit, C., Shani, B., Ti, Y.B.: On the security of supersingular
isogeny cryptosystems. In: Cheon, J.H., Takagi, T. (eds.) Advances in Cryptology
â€“ ASIACRYPT 2016, Part I. Lecture Notes in Computer Science, vol. 10031, pp.
63â€“91. Springer, Heidelberg, Germany, Hanoi, Vietnam (Dec 4â€“8, 2016). https:
//doi.org/10.1007/978-3-662-53887-6_326 T. B. Fouotsa, T. Moriya and C. Petit
21. Galbraith, S.D., Petit, C., Silva, J.: Identification protocols and signature schemes
based on supersingular isogeny problems. Journal of Cryptology 33(1), 130â€“175
(Jan 2020). https://doi.org/10.1007/s00145-019-09316-0
22. Grover, L.K.: A fast quantum mechanical algorithm for database search. In: 28th
Annual ACM Symposium on Theory of Computing. pp. 212â€“219. ACM Press,
Philadephia, PA, USA (May 22â€“24, 1996). https://doi.org/10.1145/237814.
237866
23. Jao, D., Azarderakhsh, R., Campagna, M., Costello, C., De Feo, L., Hess,
B., Jalali, A., Koziel, B., LaMacchia, B., Longa, P., Naehrig, M., Renes,
J., Soukharev, V., Urbanik, D., Pereira, G., Karabina, K., Hutchinson, A.:
SIKE. Tech. rep., National Institute of Standards and Technology (2020),
available at https://csrc.nist.gov/projects/post-quantum-cryptography/
post-quantum-cryptography-standardization/round-3-submissions
24. Jao, D., De Feo, L.: Towards quantum-resistant cryptosystems from supersingu-
lar elliptic curve isogenies. In: Yang, B.Y. (ed.) Post-Quantum Cryptography -
4th International Workshop, PQCrypto 2011. pp. 19â€“34. Springer, Heidelberg,
Germany, Tapei, Taiwan (Nov 29 â€“ Dec 2 2011). https://doi.org/10.1007/
978-3-642-25405-5_2
25. Kovalenko, I., Levitskaya, A., Savchuk, M.: Selected problems in probabilistic com-
binatorics. Naukova Dumka, Kiev (1986)
26. Maino, L., Martindale, C.: An attack on SIDH with arbitrary starting curve.
Cryptology ePrint Archive, Report 2022/1026 (2022), https://eprint.iacr.org/
2022/1026
27. Moriya, T.: Masked-degree SIDH. Cryptology ePrint Archive, Report 2022/1019
(2022), https://eprint.iacr.org/2022/1019
28. Mula,M.,Murru,N.,Pintore,F.:Randomsamplingofsupersingularellipticcurves.
Cryptology ePrint Archive, Report 2022/528 (2022), https://eprint.iacr.org/
2022/528
29. National Institute of Standards and Technology: Postâ€“quantum cryptog-
raphy standardization (Dec 2016), https://csrc.nist.gov/Projects/
Post-Quantum-Cryptography/Post-Quantum-Cryptography-Standardization
30. Oudompheng, R., Pope, G.: A note on reimplementing the castryck-decru attack
and lessons learned for SageMath. Cryptology ePrint Archive, Report 2022/1283
(2022), https://eprint.iacr.org/2022/1283
31. Petit, C.: Faster algorithms for isogeny problems using torsion point images. In:
Takagi, T., Peyrin, T. (eds.) Advances in Cryptology â€“ ASIACRYPT 2017, Part II.
Lecture Notes in Computer Science, vol. 10625, pp. 330â€“353. Springer, Heidel-
berg, Germany, Hong Kong, China (Dec 3â€“7, 2017). https://doi.org/10.1007/
978-3-319-70697-9_12
32. deQuehen,V.,Kutas,P.,Leonardi,C.,Martindale,C.,Panny,L.,Petit,C.,Stange,
K.E.: Improved torsion-point attacks on SIDH variants. In: Malkin, T., Peikert,
C. (eds.) Advances in Cryptology â€“ CRYPTO 2021, Part III. Lecture Notes in
ComputerScience,vol.12827,pp.432â€“470.Springer,Heidelberg,Germany,Virtual
Event (Aug 16â€“20, 2021). https://doi.org/10.1007/978-3-030-84252-9_15
33. Robert, D.: Breaking SIDH in polynomial time. Cryptology ePrint Archive, Report
2022/1038 (2022), https://eprint.iacr.org/2022/1038
34. Rostovtsev, A., Stolbunov, A.: Public-Key Cryptosystem Based On Isogenies.
Cryptology ePrint Archive, Report 2006/145 (2006), https://eprint.iacr.org/
2006/145M-SIDH and MD-SIDH: countering SIDH attacks by masking information 27
35. Shor, P.W.: Algorithms for quantum computation: Discrete logarithms and fac-
toring. In: 35th Annual Symposium on Foundations of Computer Science. pp.
124â€“134. IEEE Computer Society Press, Santa Fe, NM, USA (Nov 20â€“22, 1994).
https://doi.org/10.1109/SFCS.1994.365700
36. van Oorschot, P.C., Wiener, M.J.: Parallel collision search with cryptanalytic ap-
plications. Journal of Cryptology 12(1), 1â€“28 (Jan 1999). https://doi.org/10.
1007/PL00003816
A On the claims of ePrint 2022/1667
The ePrint 2022/1667 vaguely claims attacks on M-SIDH. Reading through it,
it clearly does not contain any attack against M-SIDH; it is easy to see that the
"experimental evidence" provided there only applies to SIDH parameters and
does not generalize to the parameters we recommend.
This ePrint paper runs the Castryck-Decru attack on Masked SIDH instan-
tiated with SIDH primes, that is A= 2aandB= 3b. Note that using SIDH
primes in Masked SIDH is totally insecure at the first place. Nevertheless, when
the2atorsion points are masked, intuitively, one expects the Castryck-Decru
attack to succeed 50%of the time. In fact, there are 4roots of unity modulo 2a,
these are 1,âˆ’1,2aâˆ’1âˆ’1and2aâˆ’1+ 1. As precised earlier in Section 3.3, the
attack succeeds when Î²= 1,âˆ’1, hence one expects the Castryck-Decru attack
to succeed when the masking scalar Î²is1orâˆ’1, and fail when Î²is2aâˆ’1âˆ’1
or2aâˆ’1+ 1. The ePrint 2022/1667 ran the attack and noticed that the attack
always succeeds, then claimed that this would be the case even when the cor-
rect parameters are used. We have already explained why we do not expect the
attack to work on Masked degree instantiated with the correct parameters (see
Section 3.3). Now, why does the Castryck-Decru attack works 100%of the time
(instead of 50%) when instantiated with SIDH parameters? Well, it turns out
it is because the Castryck-Decru attack does not fully use the torsion points
provided in the public key, but scales them by a small power of 2first. This is
because the implementation of the attack needs aâ€²andbâ€²such that c= 2aâ€²âˆ’3bâ€²
is smooth and its prime factors are congruent to 1mod 4(this is required for the
attack to be efficient, see [7]). This implies that the order of the torsion points
actually used in the attack divides 2aâˆ’1. Therefore, the masking scalar Î²which
liesin {1,âˆ’1,2aâˆ’1âˆ’1,2aâˆ’1+1}becomes Î²mod 2aâˆ’1= 1,âˆ’1 (mod 2aâˆ’1).This
justifies why the Castryck-Decru attack always succeeds when SIDH primes are
used.
The attack clearly does not succeed when the torsion point images having
order 2aâ€²are masked with a scalar which is neither 1norâˆ’1modulo 2aâ€². This
can be verified using the sage implementation of the attack provided in [30].
One goes to the line where the torsion point images of order 2aâ€²are computed
(for example, in line 57 of the file castryck _decru_shortcut.sage inhttps://
github.com/jack4818/Castryck-Decru-SageMath ), and replaces the torsion
points 2alpâˆ—PBand2alpâˆ—QBby(2aiâˆ’1âˆ’1)âˆ—2alpâˆ—PBand(2aiâˆ’1âˆ’1)âˆ—2alpâˆ—QB
respectively.28 T. B. Fouotsa, T. Moriya and C. Petit
Note.The non-applicability of the attacks claimed in the ePrint 2022/1667 to
M-SIDH was also pointed out on Twitter by Luca De Feo, Steven Galbraith,
PÃ©ter Kutas, Benjamin Wesolowski and other isogenists, and we thank them for
that.
B Using B-SIDH primes in M-SIDH
B-SIDHisonevariantofSIDHproposedbyCostello[12].Themaincharacteristic
of B-SIDH is the use of quadratic twists. This allows us to use the torsion points
inE[pâˆ’1]andE[p+ 1]without extending the base field, while in the original
SIDH, points which we can use must be in E[p+ 1]. Thus, the size of the prime
for B-SIDH is at most half that for SIDH .
If we can adapt this technique to our scheme, then the size of the prime may
be at most halved. Since the MD-SIDH primes are larger than twice the M-SIDH
primes, we only consider the case of M-SIDH.
In the setting of SIDH, the size of Aneeds to be large enough for its security;
however, in the setting of M-SIDH, the number of primes dividing Aneeds to
large enough. Therefore, the restriction of smoothness is harder in M-SIDH than
in SIDH.
To use the B-SIDH method for M-SIDH, we need to find a prime psatisfying
the following property:
p+ 1 = â„“1Â·Â·Â·â„“tÂ·f,
pâˆ’1 =q1Â·Â·Â·qtÂ·fâ€²,
where tâ‰¥2Î», and â„“1, . . . , â„“ tandq1, . . . , q tare distinct primes, respectively .
The basic approach to find the B-SIDH prime is to construct an integer m
such that both mandm+ 1are smooth. If 2m+ 1is prime, we set p= 2m+ 1.
In [12] and [13], some methods to find such mâ€™s are proposed. The current most
useful method is the method proposed in [13]. The main idea of this method
is to use already known solutions of the Prouhet-Tarry-Escott (PTE) problem,
which provide pairs of integer coefficient polynomials a(x) = (xâˆ’a1)Â·Â·Â·(xâˆ’as)
andb(x) = (xâˆ’b1)Â·Â·Â·(xâˆ’bs)whose difference is a constant value c. If we find
an integer â„“such that all â„“âˆ’aiâ€™s and â„“âˆ’biâ€™s are smooth, and a(â„“)/candb(â„“)/c
are integers, then b(â„“)/ccan be taken as m.
The main issue with this approach is that such â„“â€™s have a very small proba-
bility to exist. For a polynomial aâˆˆZ[x], define
Î¨a(N, M ) = #{1â‰¤mâ‰¤N|a(m)isM-smooth }.
Then, heuristically it holds that Î¨a(N, N1/u)/Nâˆ¼Ï(d1u)Â·Â·Â·Ï(dku)asNâ†’ âˆž,
where d1, . . . , d kare degrees of distinct irreducible factors of a, and Ïis the
Dickmanâ€“de Bruijn function.
Since tâ‰¥2Î», both mandm+ 1are divided by at least 2Î»distinct primes.
Then, we heuristically assume that the target value mism1/Î»-smooth. SinceM-SIDH and MD-SIDH: countering SIDH attacks by masking information 29
â„“â‰ˆm1/s, the probability of target â„“â€™s is
Î¨a(m1/s, m1/Î»)
m1/sâˆ¼Ï(Î»/s)s.
Note that sis less than or equal to 12for an already known solution of the
PTE problem. With Î»= 128, we have Ï(Î»/s)s<2âˆ’463; with Î»= 192, we have
Ï(Î»/s)s<2âˆ’835; and with Î»= 256, we have Ï(Î»/s)s<2âˆ’1246.